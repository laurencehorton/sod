---
title: "State of Open Data 2021 Descriptives"
author: "Laurence Horton"
date: "20/03/2022"
output: html_document
---

```{r, child = "sod2021_cleaning.Rmd", include = FALSE}
```

### Screener
**Q2.1 To provide a little more context for your later responses we would first like to understand a little about your research and attitudes towards open science. When was the last occasion that you published or submitted a manuscript to a journal?**
```{r Q2.1}
Q2.1 <-
  sod2021 %>%
  select(Survey, Q2.1) %>%
    drop_na()

Q2.1 <- Q2.1 %>%
    group_by(Survey) %>%
  count(Q2.1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), digits = 3))

kable(Q2.1)

Q2.1$Q2.1 <-
  factor(Q2.1$Q2.1,
          levels = c(
            "3-5 years ago",
            "1-2 years ago",
            "Within the last year"
          ))
```
```{r Q2.1 visualisations}
ggplot(Q2.1, aes(x=Survey, y=Pct, fill=Q2.1)) +
  geom_col() +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q2.1, aes(x=(Survey), y = n, fill = Q2.1)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +  
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  scale_y_continuous(limits = c(0,5000)) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q2.1, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q2.1)) +
  scale_x_continuous(breaks = 2019:2021) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q2.3 In which year was your first peer-reviewed research article published?**
```{r Q2.3}
Q2.3 <-
  sod2021 %>% count(Q2.3, sort = TRUE) %>%
  subset(Q2.3 > 0) %>%
  mutate(Pct = round(n / sum(n), 3)) # drops year values of 0

kable(Q2.3)
```
```{r Q2.3 visualisations}
ggplot(Q2.3) +
  geom_col(aes(x = Q2.3, y = n)) +
  labs(
    x = "Year",
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
  )
```

**Q2.4 Which of the following best describes your primary area of interest?**
```{r Q2.4}
Q2.4 <-
  sod2021 %>%
  select(Survey, Q2.4) %>%
    drop_na()

Q2.4 <- Q2.4 %>%
  subset(Q2.4 != 0) %>%
    group_by(Survey) %>%
  count(Q2.4, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), digits = 3))

kable(Q2.4)
```
```{r Q2.4 visualisations}
ggplot(Q2.4, aes(x = factor(Survey), y = Pct * 100, fill = Q2.4)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  labs(
    x = NULL,
    y = "Percentage",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
 theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
  )

ggplot(Q2.4, aes(x = factor(Survey), y = n, fill = Q2.4)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  labs(
    x = NULL,
    y = "Number",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
 theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
  )

ggplot(Q2.4, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q2.4)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q2.4_12 free text, include = FALSE}
Q2.4_12 <-
  sod2021 %>%
  select(Q2.4_12_TEXT) %>%
  subset(Q2.4_12_TEXT != 0) %>%
  drop_na()
Q2.4_12 <-
  unique(Q2.4_12$Q2.4_12_TEXT)
kable(Q2.4_12)
```

**Q2.6 Does any of your current research involve collaboration with others? (Please select all that apply)**
```{r Q2.6}
# Select all that apply
Q2.6_1 <-
  select(sod2021, Survey, Q2.6_1) %>%
  count(Q2.6_1) %>%
  filter(Q2.6_1 != "0") %>%
  rename("Q2.6" = "Q2.6_1")

Q2.6_2 <-
  select(sod2021, Survey, Q2.6_2) %>%
  count(Q2.6_2) %>%
  filter(Q2.6_2 != "0") %>%
  rename("Q2.6" = "Q2.6_2")

Q2.6_3 <-
  select(sod2021, Survey, Q2.6_3) %>%
  count(Q2.6_3) %>%
  filter(Q2.6_3 != "0") %>%
  rename("Q2.6" = "Q2.6_3")

Q2.6_4 <-
  select(sod2021, Survey, Q2.6_4) %>%
  count(Q2.6_4) %>%
  filter(Q2.6_4 != "0") %>%
  rename("Q2.6" = "Q2.6_4")

Q2.6_5 <-
  select(sod2021, Survey, Q2.6_5) %>%
  count(Q2.6_5) %>%
  filter(Q2.6_5!= "0") %>%
  rename("Q2.6" = "Q2.6_5")

Q2.6 <- rbind(Q2.6_1, Q2.6_2, Q2.6_3, Q2.6_4, Q2.6_5)
rm(Q2.6_1, Q2.6_2, Q2.6_3, Q2.6_4, Q2.6_5)


Q2.6 <- Q2.6 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q2.6)
```
```{r Q2.6 visualisations}
ggplot(Q2.6, aes(x= reorder(Q2.6, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = -.3,
            size = 3) +
    scale_y_continuous(limits = c(0,45)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

**Q2.7_1 To what extent do you agree/disagree with the following statements?: Making research articles open access should be common scholarly practice**
```{r Q2.7_1}
# Keep only valid responses
Q2.7_1 <- sod2021 %>%
  select(Survey, Q2.7_1) %>%
  subset(Q2.7_1 != 0) %>%
    group_by(Survey) %>%
  count(Q2.7_1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), digits = 3))

Q2.7_1$Q2.7_1 <- factor(Q2.7_1$Q2.7_1, levels = c("Strongly disagree", "Somewhat disagree", "Neutral", "Somewhat agree", "Strongly agree"))

kable(Q2.7_1)
```
```{r Q2.71_1 visualisations}
ggplot(Q2.7_1, aes(x= factor(Q2.7_1), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,70)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

**Q2.7_2 To what extent do you agree/disagree with the following statements?: Making research data openly available should be common scholarly practice (2)**
```{r Q2.7_2}
# Keep only valid responses
Q2.7_2 <- sod2021 %>%
  select(Survey, Q2.7_2) %>%
  subset(Q2.7_2 != 0) %>%
    group_by(Survey) %>%
  count(Q2.7_2, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), digits = 3))

Q2.7_2$Q2.7_2 <- factor(Q2.7_2$Q2.7_2, levels = c("Strongly disagree", "Somewhat disagree", "Neutral", "Somewhat agree", "Strongly agree"))

kable(Q2.7_2)
```
```{r Q2.7_2 visualisations}
ggplot(Q2.7_2, aes(x= factor(Q2.7_2), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,55)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

**Q2.7_3 To what extent do you agree/disagree with the following statements?: Making all research outputs openly available should be common scholarly practices (3)** 
```{r Q2.7_3}
# Keep only valid responses
Q2.7_3 <- sod2021 %>%
  select(Survey, Q2.7_3) %>%
  subset(Q2.7_3 != 0) %>%
    group_by(Survey) %>%
  count(Q2.7_3, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), digits = 3))

Q2.7_3$Q2.7_3 <- factor(Q2.7_3$Q2.7_3, levels = c("Strongly disagree", "Somewhat disagree", "Neutral", "Somewhat agree", "Strongly agree"))

kable(Q2.7_3)
```
```{r Q2.7_3 visualisations}
ggplot(Q2.7_3, aes(x= factor(Q2.7_3), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,55)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

**Q2.8 How familiar are you with the FAIR data principles in relation to open data?**
```{r Q2.8}
Q2.8 <-
  sod2021 %>%
  select(Survey, Q2.8) %>%
    drop_na()

Q2.8 <- Q2.8 %>%
    subset(Q2.8 != 0) %>%
    group_by(Survey) %>%
  count(Q2.8, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), digits = 3))

kable(Q2.8)

Q2.8$Q2.8 <-
  recode_factor(Q2.8$Q2.8,
                "I am familiar with the FAIR principles" = "Familiar",
                "I have previously heard of the FAIR principles but I am not familiar with them" = "Heard, not familiar",
                "I have never heard of the FAIR principles before now" = "Never heard of"
  )
```
```{r Q2.8 visualisations}
ggplot(Q2.8, aes(x=Survey, y=Pct, fill=Q2.8)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q2.8, aes(x= factor(Survey), y = n, fill = Q2.8)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,3500))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q2.8, aes( x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q2.8)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="FAIR principles") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)

```

### Data Sharing Practices
**Q3.1 About your research data.**    
**Do you curate/prepare your data for sharing during or shortly after the data collection process either privately or publicly?**
```{r Q3.1}
Q3.1 <-
  sod2021 %>%
  select(Survey, Q3.1) %>%
    drop_na()

Q3.1 <- Q3.1 %>%
    subset(Q3.1 != 0) %>%
    group_by(Survey) %>%
  count(Q3.1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.1)

Q3.1$Q3.1 <-
  recode_factor(Q3.1$Q3.1,
                "Yes, but only data shared with colleagues or beyond" = "Yes, only data shared",
                "Yes, but only data shared publicly" = "Yes, shared publicly",
                "No, it's not important with our data" = "No, not important",
                "No, we don't have the resource to do this but would like to" = "No, no resources",
                "No, other (please specify)" = "No, other"
                )

Q3.1$Q3.1 <- factor(Q3.1$Q3.1, levels=c(
  "Yes, all data",
  "Yes, shared publicly",
  "Yes, some",
  "Yes, only data shared",
  "No, no resources",
  "No, not important",
  "No, other"
  ))
```
```{r Q3.1 visualisations}
ggplot(Q3.1, aes(x= factor(Survey), y = Pct, fill = Q3.1)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.1, aes(x= factor(Survey), y = n, fill = Q3.1)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,2000))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.1, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q3.1)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q3.1_7 free text, include = FALSE}
Q3.1_7 <-
  sod2021 %>%
  select(Q3.1_7_TEXT) %>%
  subset(Q3.1_7_TEXT != 0) %>%
  drop_na()
Q3.1_7 <-
  unique(Q3.1_7$Q3.1_7_TEXT)
kable(Q3.1_7)
```

**Q3.2 Have you created a data management plan for your current research? (Please select all that apply)**
```{r Q3.2}
# Select all that apply
Q3.2_1 <-
  select(sod2021, Survey, Q3.2_1) %>%
  count(Q3.2_1) %>%
  filter(Q3.2_1 != "0") %>%
  rename("Q3.2" = "Q3.2_1")

Q3.2_2 <-
  select(sod2021, Survey, Q3.2_2) %>%
  count(Q3.2_2) %>%
  filter(Q3.2_2 != "0") %>%
  rename("Q3.2" = "Q3.2_2")

Q3.2_3 <-
  select(sod2021, Survey, Q3.2_3) %>%
  count(Q3.2_3) %>%
  filter(Q3.2_3 != "0") %>%
  rename("Q3.2" = "Q3.2_3")

Q3.2_4 <-
  select(sod2021, Survey, Q3.2_4) %>%
  count(Q3.2_4) %>%
  filter(Q3.2_4 != "0") %>%
  rename("Q3.2" = "Q3.2_4")

Q3.2_5 <-
  select(sod2021, Survey, Q3.2_5) %>%
  count(Q3.2_5) %>%
  filter(Q3.2_5 != "0") %>%
  rename("Q3.2" = "Q3.2_5")

Q3.2 <- rbind(Q3.2_1, Q3.2_2, Q3.2_3, Q3.2_4, Q3.2_5)
rm(Q3.2_1, Q3.2_2, Q3.2_3, Q3.2_4, Q3.2_5)


Q3.2 <- Q3.2 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.2)
```
```{r Q3.2 visualisations}
ggplot(Q3.2, aes(x= reorder(Q3.2, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

**Q3.3 At which point during the research cycle, if at all, do you make your data available?**
```{r Q3.3}
# Keep only valid responses
Q3.3 <-
  sod2021 %>%
  select(Survey, Q3.3) %>%
    drop_na()

Q3.3 <- Q3.3 %>%
  subset(Q3.3 != 0) %>%
    group_by(Survey) %>%
  count(Q3.3, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.3)
```
```{r Q3.3 visualisations}
ggplot(Q3.3, aes(x = reorder(Q3.3, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

**Q3.4 How do you share your research data with a public audience? (Please select all that apply)** 
```{r Q3.4}
# Select all that apply
Q3.4_1 <-
  select(sod2021, Survey, Q3.4_1) %>%
  count(Q3.4_1) %>%
  filter(Q3.4_1 != "0") %>%
  rename("Q3.4" = "Q3.4_1")

Q3.4_2 <-
  select(sod2021, Survey, Q3.4_2) %>%
  count(Q3.4_2) %>%
  filter(Q3.4_2 != "0") %>%
  rename("Q3.4" = "Q3.4_2")

Q3.4_3 <-
  select(sod2021, Survey, Q3.4_3) %>%
  count(Q3.4_3) %>%
  filter(Q3.4_3 != "0") %>%
  rename("Q3.4" = "Q3.4_3")

Q3.4_4 <-
  select(sod2021, Survey, Q3.4_4) %>%
  count(Q3.4_4) %>%
  filter(Q3.4_4 != "0") %>%
  rename("Q3.4" = "Q3.4_4")

Q3.4_5 <-
  select(sod2021, Survey, Q3.4_5) %>%
  count(Q3.4_5) %>%
  filter(Q3.4_5 != "0") %>%
  rename("Q3.4" = "Q3.4_5")

Q3.4 <- rbind(Q3.4_1, Q3.4_2, Q3.4_3, Q3.4_4, Q3.4_5)
rm(Q3.4_1, Q3.4_2, Q3.4_3, Q3.4_4, Q3.4_5)

Q3.4 <- Q3.4 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.4)
```
```{r Q3.4 visualisations}
ggplot(Q3.4, aes(x= reorder(Q3.4, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```
```{r Q3.4_6 free text, include = FALSE}
Q3.4_6 <-
  sod2021 %>%
  select(Q3.4_6_TEXT) %>%
  subset(Q3.4_6_TEXT != 0) %>%
  drop_na()
Q3.4_6 <-
  unique(Q3.4_6$Q3.12_6_TEXT)
kable(Q3.4_6)
```

**Q3.5 To what extent do you think you make your data open in compliance with FAIR?**
```{r Q3.5}
# Keep only valid responses
Q3.5 <-
  sod2021 %>%
  select(Survey, Q3.5) %>%
    drop_na()

Q3.5 <- Q3.5 %>%
    subset(Q3.5 != 0) %>%
    group_by(Survey) %>%
  count(Q3.5, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q3.5$Q3.5 <- factor(Q3.5$Q3.5, levels = c("I don't know", "Not at all", "Not very much", "Neutral", "Somewhat", "Very much"))

kable(Q3.5)
```
```{r Q3.5 visualisations}
ggplot(Q3.5, aes(x= factor(Survey), y = Pct, fill = Q3.5)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.5, aes(x= factor(Survey), y = n, fill = Q3.5)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,2000))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.5, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q3.5)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q3.6 Do you know who meets the costs of making your research data openly accessible (e.g. resource for curation)?**
```{r Q3.6}
# Keep only valid responses
Q3.6 <-
  sod2021 %>%
  select(Survey, Q3.6) %>%
    drop_na()

Q3.6 <- Q3.6 %>%
    subset(Q3.6 != 0) %>%
    group_by(Survey) %>%
  count(Q3.6, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.6)

Q3.6$Q3.6 <-
  recode_factor(Q3.6$Q3.6,
                "Funds identified in grant for this purpose" = "Funds identified for purpose",
                "General grant funds i.e. not specifically allocated to this purpose" = "General grant funds")
```
```{r Q3.6 visualisations}
ggplot(Q3.6, aes(x= factor(Survey), y = Pct, fill = Q3.6)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,.45))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.6, aes(x= factor(Survey), y = n, fill = Q3.6)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,1500))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.6, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q3.6)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q3.7 If you required help in making your research data openly available, which sources would you rely upon? (Please select all that apply)**
```{r Q3.7}
# Select all that apply
Q3.7_1 <-
  select(sod2021, Survey, Q3.7_1) %>%
  group_by(Survey) %>%
  count(Q3.7_1) %>%
  filter(Q3.7_1 != "0") %>%
  rename("Q3.7" = "Q3.7_1")

Q3.7_2 <-
  select(sod2021, Survey, Q3.7_2) %>%
  group_by(Survey) %>%
  count(Q3.7_2) %>%
  filter(Q3.7_2 != "0") %>%
  rename("Q3.7" = "Q3.7_2")

Q3.7_3 <-
  select(sod2021, Survey, Q3.7_3) %>%
  group_by(Survey) %>%
  count(Q3.7_3) %>%
  filter(Q3.7_3 != "0") %>%
  rename("Q3.7" = "Q3.7_3")

Q3.7_4 <-
  select(sod2021, Survey, Q3.7_4) %>%
  group_by(Survey) %>%
  count(Q3.7_4) %>%
  filter(Q3.7_4 != "0") %>%
  rename("Q3.7" = "Q3.7_4")

Q3.7_5 <-
  select(sod2021, Survey, Q3.7_5) %>%
  group_by(Survey) %>%
  count(Q3.7_5) %>%
  filter(Q3.7_5 != "0") %>%
  rename("Q3.7" = "Q3.7_5")

Q3.7_6 <-
  select(sod2021, Survey, Q3.7_6) %>%
  group_by(Survey) %>%
  count(Q3.7_6) %>%
  filter(Q3.7_6 != "0") %>%
  rename("Q3.7" = "Q3.7_6")

Q3.7_7 <-
  select(sod2021, Survey, Q3.7_7) %>%
  group_by(Survey) %>%
  count(Q3.7_7) %>%
  filter(Q3.7_7 != "0") %>%
  rename("Q3.7" = "Q3.7_7")

Q3.7_8 <-
  select(sod2021, Survey, Q3.7_8) %>%
  group_by(Survey) %>%
  count(Q3.7_8) %>%
  filter(Q3.7_8 != "0") %>%
  rename("Q3.7" = "Q3.7_8")

Q3.7_9 <-
  select(sod2021, Survey, Q3.7_9) %>%
  group_by(Survey) %>%
  count(Q3.7_9) %>%
  filter(Q3.7_9 != "0") %>%
  rename("Q3.7" = "Q3.7_9")

Q3.7_10 <-
  select(sod2021, Survey, Q3.7_10) %>%
  group_by(Survey) %>%
  count(Q3.7_10) %>%
  filter(Q3.7_10 != "0") %>%
  rename("Q3.7" = "Q3.7_10")

Q3.7_11 <-
  select(sod2021, Survey, Q3.7_11) %>%
  group_by(Survey) %>%
  count(Q3.7_11) %>%
  filter(Q3.7_11 != "0") %>%
  rename("Q3.7" = "Q3.7_11")

Q3.7 <- rbind(Q3.7_1, Q3.7_2, Q3.7_3, Q3.7_4, Q3.7_5, Q3.7_6, Q3.7_7, Q3.7_8, Q3.7_9, Q3.7_10, Q3.7_11)
rm(Q3.7_1, Q3.7_2, Q3.7_3, Q3.7_4, Q3.7_5, Q3.7_6, Q3.7_7, Q3.7_8, Q3.7_9, Q3.7_10, Q3.7_11)

# Keep only valid responses
Q3.7 <- 
  Q3.7 %>%
  group_by(Survey) %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.7)

Q3.7$Q3.7 <-
  recode_factor(Q3.7$Q3.7,
    "I would not require help making my data openly available" = "No help required"
  )
```
```{r Q3.7 visualisations}
ggplot(Q3.7, aes(x= factor(Survey), y = Pct, fill = Q3.7)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,.35))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.7, aes(x= factor(Survey), y = n, fill = Q3.7)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,2600))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.7, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q3.7)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q3.7_10 free text, include = FALSE}
Q3.7_10 <-
  sod2021 %>%
  select(Q3.7_10_TEXT) %>%
  subset(Q3.7_10_TEXT != 0) %>%
  drop_na()
Q3.7_10 <-
  unique(Q3.7_10$Q3.7_10_TEXT)
kable(Q3.7_10)
```

**Q3.8 How, if at all, do you monitor the use of data that you share publicly? (Please select all that apply)**
```{r Q3.8}
# Select all that apply
Q3.8_1 <-
  select(sod2021, Survey, Q3.8_1) %>%
  count(Q3.8_1) %>%
  filter(Q3.8_1 != "0") %>%
  rename("Q3.8" = "Q3.8_1")

Q3.8_2 <-
  select(sod2021, Survey, Q3.8_2) %>%
  count(Q3.8_2) %>%
  filter(Q3.8_2 != "0") %>%
  rename("Q3.8" = "Q3.8_2")

Q3.8_3 <-
  select(sod2021, Survey, Q3.8_3) %>%
  count(Q3.8_3) %>%
  filter(Q3.8_3 != "0") %>%
  rename("Q3.8" = "Q3.8_3")

Q3.8_4 <-
  select(sod2021, Survey, Q3.8_4) %>%
  count(Q3.8_4) %>%
  filter(Q3.8_4 != "0") %>%
  rename("Q3.8" = "Q3.8_4")

Q3.8_5 <-
  select(sod2021, Survey, Q3.8_5) %>%
  count(Q3.8_5) %>%
  filter(Q3.8_5 != "0") %>%
  rename("Q3.8" = "Q3.8_5")

Q3.8_6 <-
  select(sod2021, Survey, Q3.8_6) %>%
  count(Q3.8_6) %>%
  filter(Q3.8_6 != "0") %>%
  rename("Q3.8" = "Q3.8_6")

Q3.8 <- rbind(Q3.8_1, Q3.8_2, Q3.8_3, Q3.8_4, Q3.8_5, Q3.8_6)
rm(Q3.8_1, Q3.8_2, Q3.8_3, Q3.8_4, Q3.8_5, Q3.8_6)

# Keep only valid responses
Q3.8 <- Q3.8 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.8)

Q3.8$Q3.8 <-
  recode_factor(Q3.8$Q3.8,
                "Resolutions (i.e. frequency with which a unique identifier is clicked)" = "Resolutions")
```
```{r Q3.8 visualisations}
ggplot(Q3.8, aes(x= reorder(Q3.8, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n, "\n", round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            hjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,40)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```
```{r Q3.8_5 free text, include = FALSE}
Q3.8_5 <-
  sod2021 %>%
  select(Q3.8_5_TEXT) %>%
  subset(Q3.8_5_TEXT != 0) %>%
  drop_na()
Q3.8_5 <-
  unique(Q3.8_5$Q3.8_5_TEXT)
kable(Q3.8_5)
```

**Q3.9 To what extent are you comfortable with others using your data for the following?:**
*Q3.9_1 Replication studies (use of your data as a reference to determine whether they can be repeated under similar conditions)*
```{r Q3.9_1}
Q3.9_1 <-
  sod2021 %>%
  select(Survey, Q3.9_1) %>%
    drop_na()

Q3.9_1 <- Q3.9_1 %>%
  subset(Q3.9_1 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q3.9_1$Q3.9_1 <- factor(Q3.9_1$Q3.9_1, levels = c("Extremely uncomfortable", "Somewhat uncomfortable", "Neutral", "Somewhat comfortable", "Extremely comfortable", "I don't know"))

kable(Q3.9_1)
```
```{r Q3.9_1 visualisations}
ggplot(Q3.9_1, aes(x = Q3.9_1, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n, "\n", round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            hjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,55)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

*Q3.9_2 Reanalysis (using a different method to analyse your data set)*
```{r Q3.9_2}
Q3.9_2 <-
  sod2021 %>%
  select(Survey, Q3.9_2) %>%
    drop_na()

Q3.9_2 <- Q3.9_2 %>%
  subset(Q3.9_2 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_2, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q3.9_2$Q3.9_2 <- factor(Q3.9_2$Q3.9_2, levels = c("Extremely uncomfortable", "Somewhat uncomfortable", "Neutral", "Somewhat comfortable", "Extremely comfortable", "I don't know"))

kable(Q3.9_2)
```
```{r Q3.9_2 visualisations}
ggplot(Q3.9_2, aes(x = Q3.9_2, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n, "\n", round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            hjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,50)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

*Q3.9_3 Reinterpretation (using your data as is to answer another question)*
```{r Q3.9_3}
Q3.9_3 <-
  sod2021 %>%
  select(Survey, Q3.9_3) %>%
    drop_na()

Q3.9_3 <- Q3.9_3 %>%
  subset(Q3.9_3 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_3, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q3.9_3$Q3.9_3 <- factor(Q3.9_3$Q3.9_3, levels = c("Extremely uncomfortable", "Somewhat uncomfortable", "Neutral", "Somewhat comfortable", "Extremely comfortable", "I don't know"))

kable(Q3.9_3)
```
```{r Q3.9_3 visualisations}
ggplot(Q3.9_3, aes(x = Q3.9_3, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n, "\n", round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            hjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,50)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

*Q3.9_4 Isolated reuse (reanalysing your data to answer a new question)*
```{r Q3.9_4}
Q3.9_4 <-
  sod2021 %>%
  select(Survey, Q3.9_4) %>%
    drop_na()

Q3.9_4 <- Q3.9_4 %>%
  subset(Q3.9_4 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_4, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q3.9_4$Q3.9_4 <- factor(Q3.9_4$Q3.9_4, levels = c("Extremely uncomfortable", "Somewhat uncomfortable", "Neutral", "Somewhat comfortable", "Extremely comfortable", "I don't know"))

kable(Q3.9_4)
```
```{r Q3.9_4 visualisations}
ggplot(Q3.9_4, aes(x = Q3.9_4, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n, "\n", round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            hjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,50)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

*Q3.9_5 Combination reuse (reanalysing your data in combination with other data sets to answer a new question)*
```{r Q3.9_5}
Q3.9_5 <-
  sod2021 %>%
  select(Survey, Q3.9_5) %>%
    drop_na()

Q3.9_5 <- Q3.9_5 %>%
  subset(Q3.9_5 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_5, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q3.9_5$Q3.9_5 <- factor(Q3.9_5$Q3.9_5, levels = c("Extremely uncomfortable", "Somewhat uncomfortable", "Neutral", "Somewhat comfortable", "Extremely comfortable", "I don't know"))

kable(Q3.9_5)
```
```{r Q3.9_5 visualisations}
ggplot(Q3.9_5, aes(x = Q3.9_5, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n, "\n", round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            hjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,50)) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

**Q3.10 What problems/concerns, if any, do you have with sharing datasets? (Please select all that apply)**
```{r Q3.10}
# Select all that apply
Q3.10_1 <-
  select(sod2021, Survey, Q3.10_1) %>%
  group_by(Survey) %>%
  count(Q3.10_1) %>%
  filter(Q3.10_1 != "0") %>%
  rename("Q3.10" = "Q3.10_1")

Q3.10_2 <-
  select(sod2021, Survey, Q3.10_2) %>%
  group_by(Survey) %>%
  count(Q3.10_2) %>%
  filter(Q3.10_2 != "0") %>%
  rename("Q3.10" = "Q3.10_2")

Q3.10_3 <-
  select(sod2021, Survey, Q3.10_3) %>%
  group_by(Survey) %>%
  count(Q3.10_3) %>%
  filter(Q3.10_3 != "0") %>%
  rename("Q3.10" = "Q3.10_3")

Q3.10_4 <-
  select(sod2021, Survey, Q3.10_4) %>%
  group_by(Survey) %>%
  count(Q3.10_4) %>%
  filter(Q3.10_4 != "0") %>%
  rename("Q3.10" = "Q3.10_4")

Q3.10_5 <-
  select(sod2021, Survey, Q3.10_5) %>%
  group_by(Survey) %>%
  count(Q3.10_5) %>%
  filter(Q3.10_5 != "0") %>%
  rename("Q3.10" = "Q3.10_5")

Q3.10_6 <-
  select(sod2021, Survey, Q3.10_6) %>%
  group_by(Survey) %>%
  count(Q3.10_6) %>%
  filter(Q3.10_6 != "0") %>%
  rename("Q3.10" = "Q3.10_6")

Q3.10_7 <-
  select(sod2021, Survey, Q3.10_7) %>%
  group_by(Survey) %>%
  count(Q3.10_7) %>%
  filter(Q3.10_7 != "0") %>%
  rename("Q3.10" = "Q3.10_7")

Q3.10_8 <-
  select(sod2021, Survey, Q3.10_8) %>%
  group_by(Survey) %>%
  count(Q3.10_8) %>%
  filter(Q3.10_8 != "0") %>%
  rename("Q3.10" = "Q3.10_8")

Q3.10_9 <-
  select(sod2021, Survey, Q3.10_9) %>%
  group_by(Survey) %>%
  count(Q3.10_9) %>%
  filter(Q3.10_9 != "0") %>%
  rename("Q3.10" = "Q3.10_9")

Q3.10_10 <-
  select(sod2021, Survey, Q3.10_10) %>%
  group_by(Survey) %>%
  count(Q3.10_10) %>%
  filter(Q3.10_10 != "0") %>%
  rename("Q3.10" = "Q3.10_10")

Q3.10_11 <-
  select(sod2021, Survey, Q3.10_11) %>%
  group_by(Survey) %>%
  count(Q3.10_11) %>%
  filter(Q3.10_11 != "0") %>%
  rename("Q3.10" = "Q3.10_11")

Q3.10_12 <-
  select(sod2021, Survey, Q3.10_12) %>%
  group_by(Survey) %>%
  count(Q3.10_12) %>%
  filter(Q3.10_12 != "0") %>%
  rename("Q3.10" = "Q3.10_12")

Q3.10_13 <-
  select(sod2021, Survey, Q3.10_13) %>%
  group_by(Survey) %>%
  count(Q3.10_13) %>%
  filter(Q3.10_13 != "0") %>%
  rename("Q3.10" = "Q3.10_13")

Q3.10_14 <-
  select(sod2021, Survey, Q3.10_14) %>%
  group_by(Survey) %>%
  count(Q3.10_14) %>%
  filter(Q3.10_14 != "0") %>%
  rename("Q3.10" = "Q3.10_14")

Q3.10_15 <-
  select(sod2021, Survey, Q3.10_15) %>%
  group_by(Survey) %>%
  count(Q3.10_15) %>%
  filter(Q3.10_15 != "0") %>%
  rename("Q3.10" = "Q3.10_15")

Q3.10_16 <-
  select(sod2021, Survey, Q3.10_16) %>%
  group_by(Survey) %>%
  count(Q3.10_16) %>%
  filter(Q3.10_16 != "0") %>%
  rename("Q3.10" = "Q3.10_16")

Q3.10_17 <-
  select(sod2021, Survey, Q3.10_17) %>%
  group_by(Survey) %>%
  count(Q3.10_17) %>%
  filter(Q3.10_17 != "0") %>%
  rename("Q3.10" = "Q3.10_17")

Q3.10_18 <-
  select(sod2021, Survey, Q3.10_18) %>%
  group_by(Survey) %>%
  count(Q3.10_18) %>%
  filter(Q3.10_18 != "0") %>%
  rename("Q3.10" = "Q3.10_18")

Q3.10_19 <-
  select(sod2021, Survey, Q3.10_19) %>%
  group_by(Survey) %>%
  count(Q3.10_19) %>%
  filter(Q3.10_19 != "0") %>%
  rename("Q3.10" = "Q3.10_19")

Q3.10 <- rbind(Q3.10_1, Q3.10_2, Q3.10_3, Q3.10_4, Q3.10_5, Q3.10_6, Q3.10_7, Q3.10_8, Q3.10_9, Q3.10_10, Q3.10_11, Q3.10_12, Q3.10_13, Q3.10_14, Q3.10_15, Q3.10_16, Q3.10_17, Q3.10_18, Q3.10_19)
rm(Q3.10_1, Q3.10_2, Q3.10_3, Q3.10_4, Q3.10_5, Q3.10_6, Q3.10_7, Q3.10_8, Q3.10_9, Q3.10_10, Q3.10_11, Q3.10_12, Q3.10_13, Q3.10_14, Q3.10_15, Q3.10_16, Q3.10_17, Q3.10_18, Q3.10_19)

# Keep only valid responses
Q3.10 <- 
  Q3.10 %>%
  group_by(Survey) %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.10)

Q3.10$Q3.10 <-
  recode_factor(Q3.10$Q3.10,
                "Contain sensitive information" = "Sensitive",
                "Lack of time to deposit data" = "No time",
                "Costs of sharing data" = "Costs",
                "Unsure about copyright licensing" = "Copyright",
                "Data are too large to share" =  "Too big",
                "Not know what repository to use" = "Don't know repository",
                "Unsure I have the permission to share" = "Permission issues",
                "Data are too small or unimportant" = "Too small",
                "Organising data in a presentable and useful way" = "Useful",
                "Organising data in a presentable and usable way" = "Usable",
                "Concerns about misuse of data" = "Misuse concern",
                "Not receiving appropriate credit or acknowledgement" = "Acknowlegement",
                "Another lab may make a different interpretation of my data" = "Different interpretation",
                "Another lab may 'scoop' me to a discovery" = "'Scoop'",
                "I'm not sure I've exhausted all the potential findings yet" = "Still publishing",
                "Others may find errors in my data" = "Data errors",
                "Others may not be able to repeat my findings" = "Replication concerns",
                "Other (please specify)" = "Other",
                "I have no desire to share my data" = "Don't want to share",
                "I have no problems/concerns about sharing data" = "Want to share")
```
```{r Q3.10 visualisations}
ggplot(Q3.10, aes(x= factor(Survey), y = Pct, fill = Q3.10)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,.13))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.10, aes(x= factor(Survey), y = n, fill = Q3.10)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,2100))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.10, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q3.10)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q3.10_17 free text, include = FALSE}
Q3.10_17 <-
  sod2021 %>%
  select(Q3.10_17_TEXT) %>%
  subset(Q3.10_17_TEXT != 0) %>%
  drop_na()
Q3.10_17 <-
  unique(Q3.10_17$Q3.10_17_TEXT)
kable(Q3.10_17)
```

**Q3.11 Have you ever been involved in a collaboration as a result of data you have previously shared?**
```{r Q3.11}
Q3.11 <-
  sod2021 %>%
  select(Survey, Q3.11) %>%
    drop_na()

Q3.11 <- Q3.11 %>%
  subset(Q3.11 != 0) %>%
    group_by(Survey) %>%
  count(Q3.11, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.11)
```
```{r Q3.11 visualisations}
ggplot(Q3.11, aes(x= reorder(Q3.11, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

**Q52 Have you ever been 'scooped' (i.e. have another lab publish an result similar to your own before you do) as a result of data you have previously shared?**
```{r Q52}
Q52 <-
  sod2021 %>%
  select(Survey, Q52) %>%
    drop_na()

# Keep only valid responses
Q52 <- Q52 %>%
  subset(Q52 != 0) %>%
  drop_na() %>%
    group_by(Survey) %>%
  count(Q52, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q52)
```
```{r Q52 visualisations}
ggplot(Q52, aes(x= reorder(Q52, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n, "\n", round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

**Q3.12 What areas, if any, do you feel you need help with in regard to making your research data openly available? (Please select all that apply)**
```{r Q3.12}
Q3.12_1 <-
  select(sod2021, Survey, Q3.12_1) %>%
  group_by(Survey) %>%
  count(Q3.12_1) %>%
  filter(Q3.12_1 != "0") %>%
  rename("Q3.12" = "Q3.12_1")

Q3.12_2 <-
  select(sod2021, Survey, Q3.12_2) %>%
  group_by(Survey) %>%
  count(Q3.12_2) %>%
  filter(Q3.12_2 != "0") %>%
  rename("Q3.12" = "Q3.12_2")

Q3.12_3 <-
  select(sod2021, Survey, Q3.12_3) %>%
  group_by(Survey) %>%
  count(Q3.12_3) %>%
  filter(Q3.12_3 != "0") %>%
  rename("Q3.12" = "Q3.12_3")

Q3.12_4 <-
  select(sod2021, Survey, Q3.12_4) %>%
  group_by(Survey) %>%
  count(Q3.12_4) %>%
  filter(Q3.12_4 != "0") %>%
  rename("Q3.12" = "Q3.12_4")

Q3.12_5 <-
  select(sod2021, Survey, Q3.12_5) %>%
  group_by(Survey) %>%
  count(Q3.12_5) %>%
  filter(Q3.12_5 != "0") %>%
  rename("Q3.12" = "Q3.12_5")

Q3.12_6 <-
  select(sod2021, Survey, Q3.12_6) %>%
  group_by(Survey) %>%
  count(Q3.12_6) %>%
  filter(Q3.12_6 != "0") %>%
  rename("Q3.12" = "Q3.12_6")

Q3.12_7 <-
  select(sod2021, Survey, Q3.12_7) %>%
  group_by(Survey) %>%
  count(Q3.12_7) %>%
  filter(Q3.12_7 != "0") %>%
  rename("Q3.12" = "Q3.12_7")

Q3.12_8 <-
  select(sod2021, Survey, Q3.12_8) %>%
  group_by(Survey) %>%
  count(Q3.12_8) %>%
  filter(Q3.12_8 != "0") %>%
  rename("Q3.12" = "Q3.12_8")

Q3.12 <- rbind(Q3.12_1, Q3.12_2, Q3.12_3, Q3.12_4, Q3.12_5, Q3.12_6, Q3.12_7, Q3.12_8)
rm(Q3.12_1, Q3.12_2, Q3.12_3, Q3.12_4, Q3.12_5, Q3.12_6, Q3.12_7, Q3.12_8)

# Keep only valid responses
Q3.12 <- 
  Q3.12 %>%
  group_by(Survey) %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.12)

Q3.12$Q3.12 <-
  recode_factor(Q3.12$Q3.12,
                "Finding the time to manage my data" = "Find time",
                "Data Management Plans" = "DMPs",
                "Copyright/Licensing of data" = "Copyright/Licensing",
                "Data management policies" = "Policies",
                "Curation of data" = "Curation",
                "Finding appropriate repositories for deposition of data" = "Find repository",
                "Other (please specify)" = "Other")
```
```{r Q3.12 visualisations}
ggplot(Q3.12, aes(x= factor(Survey), y = Pct, fill = Q3.12)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,1.1))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.12, aes(x= factor(Survey), y = n, fill = Q3.12)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,5800))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q3.12, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q3.12)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q3.12_7 free text, include = FALSE}
Q3.12_7 <-
  sod2021 %>%
  select(Q3.12_7_TEXT) %>%
  subset(Q3.12_7_TEXT != 0) %>%
  drop_na()
Q3.12_7 <-
  unique(Q3.12_7$Q3.12_7_TEXT)
kable(Q3.12_7)
```

**Q3.13 Would you like more guidance on how to comply with the policies of any of the below on making your research data openly available? (Please select all that apply)**
```{r Q3.13}
Q3.13_1 <-
  select(sod2021, Survey, Q3.13_1) %>%
  count(Q3.13_1) %>%
  filter(Q3.13_1 != "0") %>%
  rename("Q3.13" = "Q3.13_1")

Q3.13_2 <-
  select(sod2021, Survey, Q3.13_2) %>%
  count(Q3.13_2) %>%
  filter(Q3.13_2 != "0") %>%
  rename("Q3.13" = "Q3.13_2")

Q3.13_3 <-
  select(sod2021, Survey, Q3.13_3) %>%
  count(Q3.13_3) %>%
  filter(Q3.13_3 != "0") %>%
  rename("Q3.13" = "Q3.13_3")

Q3.13_4 <-
  select(sod2021, Survey, Q3.13_4) %>%
  count(Q3.13_4) %>%
  filter(Q3.13_4 != "0") %>%
  rename("Q3.13" = "Q3.13_4")

Q3.13_5 <-
  select(sod2021, Survey, Q3.13_5) %>%
  count(Q3.13_5) %>%
  filter(Q3.13_5 != "0") %>%
  rename("Q3.13" = "Q3.13_5")

Q3.13 <- rbind(Q3.13_1, Q3.13_2, Q3.13_3, Q3.13_4, Q3.13_5)
rm(Q3.13_1, Q3.13_2, Q3.13_3, Q3.13_4, Q3.13_5)

# Keep only valid responses
Q3.13 <- Q3.13 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q3.13)
```
```{r Q3.13 visualisations}
ggplot(Q3.13, aes(x= reorder(Q3.13, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```


### Data reuse practices
**Q4.1 About your usage of other data sources, Since January 2020, have you reused any of the below as part of your research?: (Please select all that apply)**  
[Note: by 'reuse' we mean undertaking new analysis of a pre-existing data set, either on its own or to add to another data set, to answer a different research question to that which the collection of data was originally intended]
```{r Q4.1}
Q4.1_1 <-
  select(sod2021, Survey, Q4.1_1) %>%
  group_by(Survey) %>%
  count(Q4.1_1) %>%
  filter(Q4.1_1 != "0") %>%
  rename("Q4.1" = "Q4.1_1")

Q4.1_2 <-
  select(sod2021, Survey, Q4.1_2) %>%
  group_by(Survey) %>%
  count(Q4.1_2) %>%
  filter(Q4.1_2 != "0") %>%
  rename("Q4.1" = "Q4.1_2")

Q4.1_3 <-
  select(sod2021, Survey, Q4.1_3) %>%
  group_by(Survey) %>%
  count(Q4.1_3) %>%
  filter(Q4.1_3 != "0") %>%
  rename("Q4.1" = "Q4.1_3")

Q4.1 <- rbind(Q4.1_1, Q4.1_2, Q4.1_3)
rm(Q4.1_1, Q4.1_2, Q4.1_3)

# Include all responses
Q4.1 <- Q4.1 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.1)
```
```{r Q4.1 visualisations}
ggplot(Q4.1, aes(x=Survey, y=Pct, fill=Q4.1)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q4.1, aes(x=(Survey), y = n, fill = Q4.1)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%")),
            position = position_dodge(width = 0.9),
            vjust = 1.3,
            size = 3) +  
  scale_x_continuous(breaks = 2016:2021) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q4.1, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q4.1)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
  scale_x_continuous(breaks = 2016:2021) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q4.2 To what extent has the COVID-19 pandemic affected your reuse of data?**
*Q4.2_1 Your own data (1)*
```{r Q4.2_1}
Q4.2_1 <-
  sod2021 %>%
  select(Survey, Q4.2_1) %>%
    drop_na()

# Keep only valid responses
Q4.2_1 <- Q4.2_1 %>%
    group_by(Survey) %>%
    subset(Q4.2_1 != 0) %>%
  count(Q4.2_1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.2_1)

Q4.2_1$Q4.2_1 <-
  recode_factor(Q4.2_1$Q4.2_1,
                "My reuse of data has not changed since the onset of the pandemic" = "Not changed",
                "I have reused it somewhat more since the onset of the pandemic"  = "Somewhat",
                "I have reused it a lot more since the onset of the pandemic" = "A lot more",
                "I have reused it somewhat less since the onset of the pandemic" = "Somewhat less",
                "I have reused it a lot less since the onset of the pandemic" = "A lot less"
                )

Q4.2_1$Q4.2_1 <-
  factor(Q4.2_1$Q4.2_1,
         labels = c("A lot more",
                    "Somewhat more",
                    "Not changed",
                    "Somewhat less",
                    "A lot less"
                    )
         )
```
```{r Q4.2_1 visualisations}
ggplot(Q4.2_1, aes(x = "", y = n, fill = Q4.2_1)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.2_1, aes(x = Q4.2_1, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,65))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.2_2 Openly accessible data shared by other research groups (2)*
```{r Q4.2_2}
Q4.2_2 <-
  sod2021 %>%
  select(Survey, Q4.2_2) %>%
    drop_na()

# Keep only valid responses
Q4.2_2 <- Q4.2_2 %>%
    group_by(Survey) %>%
    subset(Q4.2_2 != 0) %>%
  count(Q4.2_2, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.2_2)

Q4.2_2$Q4.2_2 <-
  recode_factor(Q4.2_2$Q4.2_2,
                "My reuse of data has not changed since the onset of the pandemic" = "Not changed",
                "I have reused it somewhat more since the onset of the pandemic"  = "Somewhat",
                "I have reused it a lot more since the onset of the pandemic" = "A lot more",
                "I have reused it somewhat less since the onset of the pandemic" = "Somewhat less",
                "I have reused it a lot less since the onset of the pandemic" = "A lot less"
                )

Q4.2_2$Q4.2_2 <-
  factor(Q4.2_2$Q4.2_2,
         labels = c("A lot more",
                    "Somewhat more",
                    "Not changed",
                    "Somewhat less",
                    "A lot less"
                    )
         )
```
```{r Q4.2_2 visualisations}
ggplot(Q4.2_2, aes(x = "", y = n, fill = Q4.2_2)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.2_2, aes(x = Q4.2_2, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,60))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

**Q4.3 How do you think the data shared by others has or could benefit you? (Please select all that apply)**
```{r Q4.3}
Q4.3_1 <-
  select(sod2021, Survey, Q4.3_1) %>%
  group_by(Survey) %>%
  count(Q4.3_1) %>%
  filter(Q4.3_1 != "0") %>%
  rename("Q4.3" = "Q4.3_1")

Q4.3_2 <-
  select(sod2021, Survey, Q4.3_2) %>%
  group_by(Survey) %>%
  count(Q4.3_2) %>%
  filter(Q4.3_2 != "0") %>%
  rename("Q4.3" = "Q4.3_2")

Q4.3_3 <-
  select(sod2021, Survey, Q4.3_3) %>%
  group_by(Survey) %>%
  count(Q4.3_3) %>%
  filter(Q4.3_3 != "0") %>%
  rename("Q4.3" = "Q4.3_3")

Q4.3_4 <-
  select(sod2021, Survey, Q4.3_4) %>%
  group_by(Survey) %>%
  count(Q4.3_4) %>%
  filter(Q4.3_4 != "0") %>%
  rename("Q4.3" = "Q4.3_4")

Q4.3_5 <-
  select(sod2021, Survey, Q4.3_5) %>%
  group_by(Survey) %>%
  count(Q4.3_5) %>%
  filter(Q4.3_5 != "0") %>%
  rename("Q4.3" = "Q4.3_5")

Q4.3_6 <-
  select(sod2021, Survey, Q4.3_6) %>%
  group_by(Survey) %>%
  count(Q4.3_6) %>%
  filter(Q4.3_6 != "0") %>%
  rename("Q4.3" = "Q4.3_6")

Q4.3 <- rbind(Q4.3_1, Q4.3_2, Q4.3_3, Q4.3_4, Q4.3_5, Q4.3_6)
rm(Q4.3_1, Q4.3_2, Q4.3_3, Q4.3_4, Q4.3_5, Q4.3_6)

# Include all responses
Q4.3 <- Q4.3 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.3)
```
```{r Q4.3 visualisations}
ggplot(Q4.3, aes(x=Survey, y=Pct, fill=Q4.3)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q4.3, aes(x=(Survey), y = n, fill = Q4.3)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +  
  scale_x_continuous(breaks = 2016:2021) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q4.3, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q4.3)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
  scale_x_continuous(breaks = 2016:2021) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q4.3_5 free text, include = FALSE}
Q4.3_5 <-
  sod2021 %>%
  select(Q4.3_5_TEXT) %>%
  subset(Q4.3_5_TEXT != 0) %>%
  drop_na()
Q4.3_5 <-
  unique(Q4.3_5$Q4.3_5_TEXT)
kable(Q4.3_5)
```

**Q4.4 Where have you previously obtained research data which has been collected by other research groups, for your own reuse? (Please select all that apply)**
```{r Q4.4}
Q4.4_1 <-
  select(sod2021, Survey, Q4.4_1) %>%
  count(Q4.4_1) %>%
  filter(Q4.4_1 != "0") %>%
  rename("Q4.4" = "Q4.4_1")

Q4.4_2 <-
  select(sod2021, Survey, Q4.4_2) %>%
  count(Q4.4_2) %>%
  filter(Q4.4_2 != "0") %>%
  rename("Q4.4" = "Q4.4_2")

Q4.4_3 <-
  select(sod2021, Survey, Q4.4_3) %>%
  count(Q4.4_3) %>%
  filter(Q4.4_3 != "0") %>%
  rename("Q4.4" = "Q4.4_3")

Q4.4_4 <-
  select(sod2021, Survey, Q4.4_4) %>%
  count(Q4.4_4) %>%
  filter(Q4.4_4 != "0") %>%
  rename("Q4.4" = "Q4.4_4")

Q4.4_5 <-
  select(sod2021, Survey, Q4.4_5) %>%
  count(Q4.4_5) %>%
  filter(Q4.4_5 != "0") %>%
  rename("Q4.4" = "Q4.4_5")

Q4.4_6 <-
  select(sod2021, Survey, Q4.4_6) %>%
  count(Q4.4_6) %>%
  filter(Q4.4_6 != "0") %>%
  rename("Q4.4" = "Q4.4_6")

Q4.4 <- rbind(Q4.4_1, Q4.4_2, Q4.4_3, Q4.4_4, Q4.4_5, Q4.4_6)
rm(Q4.4_1, Q4.4_2, Q4.4_3, Q4.4_4, Q4.4_5, Q4.4_6)

# Keep only valid responses
Q4.4 <- Q4.4 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.4)

Q4.4$Q4.4 <-
  recode_factor(Q4.4$Q4.4,
                "Downloaded directly from a data repository" = "Repository",
                "Data were available within a published research article" = "Research article",
                "Data were linked from a published data article" = "Data article",
                "Directly from the researcher who collected the data (e.g. via email)" = "On request",
                "Data were available from a blog post" = "Blog post",
                "Other (please specify)" = "Other"
  )
```
```{r Q4.4 visualisations}
ggplot(Q4.4, aes(x = "", y = n, fill = Q4.4)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.4, aes(x = reorder(Q4.4, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```
```{r Q4.4_6 free text, include = FALSE}
Q4.4_6 <-
  sod2021 %>%
  select(Q4.4_6_TEXT) %>%
  subset(Q4.4_6_TEXT != 0) %>%
  drop_na()
Q4.4_6 <-
  unique(Q4.4_6$Q4.4_6_TEXT)
kable(Q4.4_6)
```

**Q4.5 What was your aim in using previously generated data? (Please select all that apply)**
```{r Q4.5}
Q4.5_1 <-
  select(sod2021, Survey, Q4.5_1) %>%
  count(Q4.5_1) %>%
  filter(Q4.5_1 != "0") %>%
  rename("Q4.5" = "Q4.5_1")

Q4.5_2 <-
  select(sod2021, Survey, Q4.5_2) %>%
  count(Q4.5_2) %>%
  filter(Q4.5_2 != "0") %>%
  rename("Q4.5" = "Q4.5_2")

Q4.5_3 <-
  select(sod2021, Survey, Q4.5_3) %>%
  count(Q4.5_3) %>%
  filter(Q4.5_3 != "0") %>%
  rename("Q4.5" = "Q4.5_3")

Q4.5_4 <-
  select(sod2021, Survey, Q4.5_4) %>%
  count(Q4.5_4) %>%
  filter(Q4.5_4 != "0") %>%
  rename("Q4.5" = "Q4.5_4")

Q4.5_5 <-
  select(sod2021, Survey, Q4.5_5) %>%
  count(Q4.5_5) %>%
  filter(Q4.5_5 != "0") %>%
  rename("Q4.5" = "Q4.5_5")

Q4.5_6 <-
  select(sod2021, Survey, Q4.5_6) %>%
  count(Q4.5_6) %>%
  filter(Q4.5_6 != "0") %>%
  rename("Q4.5" = "Q4.5_6")

Q4.5 <- rbind(Q4.5_1, Q4.5_2, Q4.5_3, Q4.5_4, Q4.5_5, Q4.5_6)
rm(Q4.5_1, Q4.5_2, Q4.5_3, Q4.5_4, Q4.5_5, Q4.5_6)

# Keep only valid responses
Q4.5 <- Q4.5 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.5)

Q4.5$Q4.5 <-
  recode_factor(Q4.5$Q4.5,
                "Replication studies (use of the data as a reference to determine whether they can be repeated under similar conditions)" = "Replication",
                "Reanalysis (analysing the data set using a different method to test the same research question)" = "Reanalysis",
                "Reinterpretation (using the data as is to answer another question)" = "Reinterpretation",
                "Isolated reuse (reanalysing the data to answer a new question)" = "Isolated reuse",
                "Combination reuse (reanalysing the data in combination with other data sets to answer a new question)" = "Combination reuse",
                "Other (please specify)" = "Other"
  )
```
```{r Q4.5 visualisations}
ggplot(Q4.5, aes(x = "", y = n, fill = Q4.5)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.5, aes(x = reorder(Q4.5, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```
```{r Q4.5_6 free text, include = FALSE}
Q4.5_6 <-
  sod2021 %>%
  select(Q4.5_6_TEXT) %>%
  subset(Q4.5_6_TEXT != 0) %>%
  drop_na()
Q4.5_6 <-
  unique(Q4.5_6$Q4.5_6_TEXT)
kable(Q4.5_6)
```

**Q4.6 How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set? Extremely important (1)	Somewhat important (2)	Moderately important (3)	Slightly important (4)	Not at all important (5)	I don't know (6)**

*Q4.6_1 The data are available from a publicly available repository (1)*
```{r Q4.6_1}
Q4.6_1 <-
  sod2021 %>%
  select(Survey, Q4.6_1) %>%
    drop_na()

# Keep only valid responses
Q4.6_1 <- Q4.6_1 %>%
    group_by(Survey) %>%
    subset(Q4.6_1 != 0) %>%
  count(Q4.6_1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_1$Q4.6_1 <- factor(Q4.6_1$Q4.6_1, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_1)
```
```{r Q4.6_1 visualisations}
ggplot(Q4.6_1, aes(x = "", y = n, fill = Q4.6_1)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_1, aes(x = Q4.6_1, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,56))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_2 The data are new (e.g. released within the last year) (2)* 
```{r Q4.6_2}
Q4.6_2 <-
  sod2021 %>%
  select(Survey, Q4.6_2) %>%
    drop_na()

# Keep only valid responses
Q4.6_2 <- Q4.6_2 %>%
    group_by(Survey) %>%
    subset(Q4.6_2 != 0) %>%
  count(Q4.6_2, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_2$Q4.6_2 <- factor(Q4.6_2$Q4.6_2, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_2)
```
```{r Q4.6_2 visualisations}
ggplot(Q4.6_2, aes(x = "", y = n, fill = Q4.6_2)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_2, aes(x = Q4.6_2, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_3 The data can be viewed, downloaded and edited on an application I have available (3)* 
```{r Q4.6_3}
Q4.6_3 <-
  sod2021 %>%
  select(Survey, Q4.6_3) %>%
    drop_na()

# Keep only valid responses
Q4.6_3 <- Q4.6_3 %>%
    group_by(Survey) %>%
    subset(Q4.6_3 != 0) %>%
  count(Q4.6_3, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_3$Q4.6_3 <- factor(Q4.6_3$Q4.6_3, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_3)
```
```{r Q4.6_3 visualisations}
ggplot(Q4.6_3, aes(x = "", y = n, fill = Q4.6_3)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_3, aes(x = Q4.6_3, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,47))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_4 The data come from a known source (e.g. familiar institution or academic) (4)* 
```{r Q4.6_4}
Q4.6_4 <-
  sod2021 %>%
  select(Survey, Q4.6_4) %>%
    drop_na()

# Keep only valid responses
Q4.6_4 <- Q4.6_4 %>%
    group_by(Survey) %>%
    subset(Q4.6_4 != 0) %>%
  count(Q4.6_4, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_4$Q4.6_4 <- factor(Q4.6_4$Q4.6_4, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_4)
```
```{r Q4.6_4 visualisations}
ggplot(Q4.6_4, aes(x = "", y = n, fill = Q4.6_4)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_4, aes(x = Q4.6_4, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,51))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_5 The data are in a repository that I know checks/curates the data (5)* 
```{r Q4.6_5}
Q4.6_5 <-
  sod2021 %>%
  select(Survey, Q4.6_5) %>%
    drop_na()

# Keep only valid responses
Q4.6_5 <- Q4.6_5 %>%
    group_by(Survey) %>%
    subset(Q4.6_5 != 0) %>%
  count(Q4.6_5, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_5$Q4.6_5 <- factor(Q4.6_5$Q4.6_5, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_5)
```
```{r Q4.6_5 visualisations}
ggplot(Q4.6_5, aes(x = "", y = n, fill = Q4.6_5)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_5, aes(x = Q4.6_5, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,46))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_6 The data are associated with a peer review article (6)* 
```{r Q4.6_6}
Q4.6_6 <-
  sod2021 %>%
  select(Survey, Q4.6_6) %>%
    drop_na()

# Keep only valid responses
Q4.6_6 <- Q4.6_6 %>%
    group_by(Survey) %>%
    subset(Q4.6_6 != 0) %>%
  count(Q4.6_6, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_6$Q4.6_6 <- factor(Q4.6_6$Q4.6_6, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_6)
```
```{r Q4.6_6 visualisations}
ggplot(Q4.6_6, aes(x = "", y = n, fill = Q4.6_6)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_6, aes(x = Q4.6_6, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,47))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_7 Data visualizations (e.g. figures, charts) reflect the true state of the source data (7)*
```{r Q4.6_7}
Q4.6_7 <-
  sod2021 %>%
  select(Survey, Q4.6_7) %>%
    drop_na()

# Keep only valid responses
Q4.6_7 <- Q4.6_7 %>%
    group_by(Survey) %>%
    subset(Q4.6_7 != 0) %>%
  count(Q4.6_7, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_7$Q4.6_7 <- factor(Q4.6_7$Q4.6_7, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_7)
```
```{r Q4.6_7 visualisations}
ggplot(Q4.6_7, aes(x = "", y = n, fill = Q4.6_7)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_7, aes(x = Q4.6_7, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_8 Data is consistent with previously published findings (8)* 
```{r Q4.6_8}
Q4.6_8 <-
  sod2021 %>%
  select(Survey, Q4.6_8) %>%
    drop_na()

# Keep only valid responses
Q4.6_8 <- Q4.6_8 %>%
    group_by(Survey) %>%
    subset(Q4.6_8 != 0) %>%
  count(Q4.6_8, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_8$Q4.6_8 <- factor(Q4.6_8$Q4.6_8, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_8)
```
```{r Q4.6_8 visualisations}
ggplot(Q4.6_8, aes(x = "", y = n, fill = Q4.6_8)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_8, aes(x = Q4.6_8, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_9 Data are presented in a clear and understandable way (data layout, content and format etc.) (9)* 
```{r Q4.6_9}
Q4.6_9 <-
  sod2021 %>%
  select(Survey, Q4.6_9) %>%
    drop_na()

# Keep only valid responses
Q4.6_9 <- Q4.6_9 %>%
    group_by(Survey) %>%
    subset(Q4.6_9 != 0) %>%
  count(Q4.6_9, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_9$Q4.6_9 <- factor(Q4.6_9$Q4.6_9, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_9)
```
```{r Q4.6_9 visualisations}
ggplot(Q4.6_9, aes(x = "", y = n, fill = Q4.6_9)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_9, aes(x = Q4.6_9, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,61))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_10 The data set is complete for my needs (10)* 
```{r Q4.6_10}
Q4.6_10 <-
  sod2021 %>%
  select(Survey, Q4.6_10) %>%
    drop_na()

# Keep only valid responses
Q4.6_10 <- Q4.6_10 %>%
    group_by(Survey) %>%
    subset(Q4.6_10 != 0) %>%
  count(Q4.6_10, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_10$Q4.6_10 <- factor(Q4.6_10$Q4.6_10, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_10)
```
```{r Q4.6_10  visualisations}
ggplot(Q4.6_10, aes(x = "", y = n, fill = Q4.6_10)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_10, aes(x = Q4.6_10, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,45))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_11 Data have clear descriptions, classifications and coding (i.e. data are accompanied with sufficient context) (11)* 
```{r Q4.6_11}
Q4.6_11 <-
  sod2021 %>%
  select(Survey, Q4.6_11) %>%
    drop_na()

# Keep only valid responses
Q4.6_11 <- Q4.6_11 %>%
    group_by(Survey) %>%
    subset(Q4.6_11 != 0) %>%
  count(Q4.6_11, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_11$Q4.6_11 <- factor(Q4.6_11$Q4.6_11, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_11)
```
```{r Q4.6_11 visualisations}
ggplot(Q4.6_11, aes(x = "", y = n, fill = Q4.6_11)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_11, aes(x = Q4.6_11, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,65))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.6_12 The data have been highly used, i.e. they have high usage metrics (e.g. citations, downloads, views etc.) (12)* 
```{r Q4.6_12}
Q4.6_12 <-
  sod2021 %>%
  select(Survey, Q4.6_12) %>%
    drop_na()

# Keep only valid responses
Q4.6_12 <- Q4.6_12 %>%
    group_by(Survey) %>%
    subset(Q4.6_12 != 0) %>%
  count(Q4.6_12, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.6_12$Q4.6_12 <- factor(Q4.6_12$Q4.6_12, levels = c("Not at all important", "Slightly important", "Moderately important", "Somewhat important", "Extremely important", "I don't know"))

kable(Q4.6_12)
```
```{r Q4.6_12 visualisations}
ggplot(Q4.6_12, aes(x = "", y = n, fill = Q4.6_12)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 3, nrow = 2, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.6_12, aes(x = Q4.6_12, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

**Q4.7 To what extent do you agree/disagree with the following statements?: Strongly agree (1)	Somewhat agree (2)	Neutral (3)	Somewhat disagree (4)	Strongly disagree (5)**  
*Q4.7_1 Data that are 'easy' to find and access improves my perception of its quality (1)*
```{r Q4.7_1}
Q4.7_1 <-
  sod2021 %>%
  select(Survey, Q4.7_1) %>%
    drop_na()

# Keep only valid responses
Q4.7_1 <- Q4.7_1 %>%
    group_by(Survey) %>%
    subset(Q4.7_1 != 0) %>%
  count(Q4.7_1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.7_1$Q4.7_1 <- factor(Q4.7_1$Q4.7_1, levels = c("Strongly agree",	"Somewhat agree",	"Neutral", "Somewhat disagree", "Strongly disagree"))

kable(Q4.7_1)
```
```{r Q4.7_1 visualisations}
ggplot(Q4.7_1, aes(x = "", y = n, fill = Q4.7_1)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.7_1, aes(x = Q4.7_1, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,37))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

*Q4.7_2 Shared data add to the credibility of a research article (2)* 
```{r Q4.7_2}
Q4.7_2 <-
  sod2021 %>%
  select(Survey, Q4.7_2) %>%
    drop_na()

# Keep only valid responses
Q4.7_2 <- Q4.7_2 %>%
    group_by(Survey) %>%
    subset(Q4.7_2 != 0) %>%
  count(Q4.7_2, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

Q4.7_2$Q4.7_2 <- factor(Q4.7_2$Q4.7_2, levels = c("Strongly agree",	"Somewhat agree",	"Neutral", "Somewhat disagree", "Strongly disagree"))

kable(Q4.7_2)
```
```{r Q4.7_2 visualisations}
ggplot(Q4.7_2, aes(x = "", y = n, fill = Q4.7_2)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.7_2, aes(x = Q4.7_2, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,49))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

**Q4.8 We would now like to ask you to think about the last occasion on which you tried to get access to a data set produced by another research group. Please answer the following questions with this experience in mind. Were you able to get access to the data set?**
```{r Q4.8}
Q4.8 <-
  sod2021 %>%
  select(Survey, Q4.8) %>%
    drop_na()

# Keep only valid responses
Q4.8 <- Q4.8 %>%
    group_by(Survey) %>%
    subset(Q4.8 != 0) %>%
  count(Q4.8, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.8)
```
```{r Q4.8 visualisations}
ggplot(Q4.8, aes(x = "", y = n, fill = Q4.8)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.8, aes(x = Q4.8, y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
)
```

**Q4.9 How did you gain access to the data set?**
```{r Q4.9}
Q4.9 <-
  sod2021 %>%
  select(Survey, Q4.9) %>%
    drop_na()

# Keep only valid responses
Q4.9 <- Q4.9 %>%
    group_by(Survey) %>%
    subset(Q4.9 != 0) %>%
  count(Q4.9, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.9)

Q4.9$Q4.9 <-
  recode_factor(Q4.9$Q4.9,
                "Direct from the research group/authors" = "From research group/authors",
                "A published research article" = "Research article",
                "A published data article" = "Data article",
                "Through a third-party" = "Through 3rd party",
                "Other (please specify)" = "Other"
  )
```
```{r Q4.9 visualisations}
ggplot(Q4.9, aes(x = "", y = n, fill = Q4.9)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.9, aes(x = reorder(Q4.9, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = -.3,
            size = 3) +
  scale_y_continuous(limits = c(0,31))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```
```{r Q4.9_7 free text, include = FALSE}
Q4.9_7 <-
  sod2021 %>%
  select(Q4.9_7_TEXT) %>%
  subset(Q4.9_7_TEXT != 0) %>%
  drop_na()
Q4.9_7 <-
  unique(Q4.9_7$Q4.9_7_TEXT)
kable(Q4.9_7)
```

**Q4.10 What was included in the data set?**
```{r Q4.10}
Q4.10_1 <-
  select(sod2021, Survey, Q4.10_1) %>%
  count(Q4.10_1) %>%
  filter(Q4.10_1 != "0") %>%
  rename("Q4.10" = "Q4.10_1")

Q4.10_2 <-
  select(sod2021, Survey, Q4.10_2) %>%
  count(Q4.10_2) %>%
  filter(Q4.10_2 != "0") %>%
  rename("Q4.10" = "Q4.10_2")

Q4.10_3 <-
  select(sod2021, Survey, Q4.10_3) %>%
  count(Q4.10_3) %>%
  filter(Q4.10_3 != "0") %>%
  rename("Q4.10" = "Q4.10_3")

Q4.10_4 <-
  select(sod2021, Survey, Q4.10_4) %>%
  count(Q4.10_4) %>%
  filter(Q4.10_4 != "0") %>%
  rename("Q4.10" = "Q4.10_4")

Q4.10_5 <-
  select(sod2021, Survey, Q4.10_5) %>%
  count(Q4.10_5) %>%
  filter(Q4.10_5 != "0") %>%
  rename("Q4.10" = "Q4.10_5")

Q4.10_6 <-
  select(sod2021, Survey, Q4.10_6) %>%
  count(Q4.10_6) %>%
  filter(Q4.10_6 != "0") %>%
  rename("Q4.10" = "Q4.10_6")

Q4.10_7 <-
  select(sod2021, Survey, Q4.10_7) %>%
  count(Q4.10_7) %>%
  filter(Q4.10_7 != "0") %>%
  rename("Q4.10" = "Q4.10_7")

Q4.10_8 <-
  select(sod2021, Survey, Q4.10_8) %>%
  count(Q4.10_8) %>%
  filter(Q4.10_8 != "0") %>%
  rename("Q4.10" = "Q4.10_8")

Q4.10 <- rbind(Q4.10_1, Q4.10_2, Q4.10_3, Q4.10_4, Q4.10_5, Q4.10_6, Q4.10_7, Q4.10_8)
rm(Q4.10_1, Q4.10_2, Q4.10_3, Q4.10_4, Q4.10_5, Q4.10_6, Q4.10_7, Q4.10_8)

# Keep only valid responses
Q4.10 <- Q4.10 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.10)
```
```{r Q4.10 visualisations}
ggplot(Q4.10, aes(x = "", y = n, fill = Q4.10)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 4, nrow = 3, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.10, aes(x = reorder(Q4.10, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```

**Q4.11 Were you able to reuse the dataset for your intended purpose?**
```{r Q4.11}
Q4.11 <-
  sod2021 %>%
  select(Survey, Q4.11) %>%
    drop_na()

# Keep only valid responses
Q4.11 <- Q4.11 %>%
    group_by(Survey) %>%
    subset(Q4.11 != 0) %>%
  count(Q4.11, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.11)
```
```{r Q4.11 visualisations}
ggplot(Q4.11, aes(x = "", y = n, fill = Q4.11)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()
```

**Q4.12 Why were you unable to reuse the dataset for your intended purpose?**
```{r Q4.12}
Q4.12_1 <-
  select(sod2021, Survey, Q4.12_1) %>%
  count(Q4.12_1) %>%
  filter(Q4.12_1 != "0") %>%
  rename("Q4.12" = "Q4.12_1")

Q4.12_2 <-
  select(sod2021, Survey, Q4.12_2) %>%
  count(Q4.12_2) %>%
  filter(Q4.12_2 != "0") %>%
  rename("Q4.12" = "Q4.12_2")

Q4.12_3 <-
  select(sod2021, Survey, Q4.12_3) %>%
  count(Q4.12_3) %>%
  filter(Q4.12_3 != "0") %>%
  rename("Q4.12" = "Q4.12_3")

Q4.12_4 <-
  select(sod2021, Survey, Q4.12_4) %>%
  count(Q4.12_4) %>%
  filter(Q4.12_4 != "0") %>%
  rename("Q4.12" = "Q4.12_4")

Q4.12_5 <-
  select(sod2021, Survey, Q4.12_5) %>%
  count(Q4.12_5) %>%
  filter(Q4.12_5 != "0") %>%
  rename("Q4.12" = "Q4.12_5")

Q4.12_6 <-
  select(sod2021, Survey, Q4.12_6) %>%
  count(Q4.12_6) %>%
  filter(Q4.12_6 != "0") %>%
  rename("Q4.12" = "Q4.12_6")

Q4.12 <- rbind(Q4.12_1, Q4.12_2, Q4.12_3, Q4.12_4, Q4.12_5, Q4.12_6)
rm(Q4.12_1, Q4.12_2, Q4.12_3, Q4.12_4, Q4.12_5, Q4.12_6)

# Keep only valid responses
Q4.12 <- Q4.12 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q4.12)

Q4.12$Q4.12 <-
  recode_factor(Q4.12$Q4.12,
                "I could not validate the quality of the data"	= "Validation issue",
                "The data were not suitable for my intended use"	= "Suitability issue",
                "Technical issues (e.g. could not get access to necessary software)"	= "Technical issues",
                "It was not annotated sufficiently for understanding"	= "Annotation issues",
                "The license didn't permit reuse/could not get reuse permission" = "Licence issues",
                "Other (please specify)" = "Other"
)
```
```{r Q4.12 visualisations}
ggplot(Q4.12, aes(x = "", y = n, fill = Q4.12)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  guides(fill = guide_legend(ncol = 4, nrow = 3, byrow = FALSE)) +
  coord_flip()

ggplot(Q4.12, aes(x = reorder(Q4.12, n), y = Pct * 100)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            hjust = 1.3,
            size = 3,
            colour = "#FFFFFF") +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
) +
  coord_flip()
```
```{r Q4.12_6 free text, include = FALSE}
Q4.12_6 <-
  sod2021 %>%
  select(Q4.12_6_TEXT) %>%
  subset(Q4.12_6_TEXT != 0) %>%
  drop_na()
Q4.12_6 <-
  unique(Q4.12_6$Q4.12_6_TEXT)
kable(Q4.12_6)
```

### Credit and recognition for data sharing
**Q5.1 Do you think researchers currently get sufficient credit for sharing data?**
```{r Q5.1}
Q5.1 <-
  sod2021 %>%
  select(Survey, Q5.1) %>%
    drop_na()

# Keep only valid responses
Q5.1 <- Q5.1 %>%
  subset(Q5.1 != 0) %>%
    group_by(Survey) %>%
  count(Q5.1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q5.1)

Q5.1$Q5.1 <-
  factor(Q5.1$Q5.1,
         levels = c(
           "No",
           "No, they receive too little credit",
           "No, they receive too much credit",
           "I don't know",
           "Not sure",
           "Yes"
           )
         )
```
```{r Q5.1 visualisations}
ggplot(Q5.1, aes(x=Survey, y=Pct, fill=Q5.1)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q5.1, aes(x=(Survey), y = n, fill = Q5.1)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +  
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  scale_y_continuous(limits = c(0,4300)) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q5.1, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q5.1)) +
  scale_x_continuous(breaks = 2018:2021) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q5.2 What circumstances would motivate you to share your data?**
```{r Q5.2}
Q5.2_1 <-
  select(sod2021, Survey, Q5.2_1) %>%
  group_by(Survey) %>%
  count(Q5.2_1) %>%
  filter(Q5.2_1 != "0") %>%
  rename("Q5.2" = "Q5.2_1")

Q5.2_2 <-
  select(sod2021, Survey, Q5.2_2) %>%
  group_by(Survey) %>%
  count(Q5.2_2) %>%
  filter(Q5.2_2 != "0") %>%
  rename("Q5.2" = "Q5.2_2")

Q5.2_3 <-
  select(sod2021, Survey, Q5.2_3) %>%
  group_by(Survey) %>%
  count(Q5.2_3) %>%
  filter(Q5.2_3 != "0") %>%
  rename("Q5.2" = "Q5.2_3")

Q5.2_4 <-
  select(sod2021, Survey, Q5.2_4) %>%
  group_by(Survey) %>%
  count(Q5.2_4) %>%
  filter(Q5.2_4 != "0") %>%
  rename("Q5.2" = "Q5.2_4")

Q5.2_5 <-
  select(sod2021, Survey, Q5.2_5) %>%
  group_by(Survey) %>%
  count(Q5.2_5) %>%
  filter(Q5.2_5 != "0") %>%
  rename("Q5.2" = "Q5.2_5")

Q5.2_6 <-
  select(sod2021, Survey, Q5.2_6) %>%
  group_by(Survey) %>%
  count(Q5.2_6) %>%
  filter(Q5.2_6 != "0") %>%
  rename("Q5.2" = "Q5.2_6")

Q5.2_7 <-
  select(sod2021, Survey, Q5.2_7) %>%
  group_by(Survey) %>%
  count(Q5.2_7) %>%
  filter(Q5.2_7 != "0") %>%
  rename("Q5.2" = "Q5.2_7")

Q5.2_8 <-
  select(sod2021, Survey, Q5.2_8) %>%
  group_by(Survey) %>%
  count(Q5.2_8) %>%
  filter(Q5.2_8 != "0") %>%
  rename("Q5.2" = "Q5.2_8")

Q5.2_9 <-
  select(sod2021, Survey, Q5.2_9) %>%
  group_by(Survey) %>%
  count(Q5.2_9) %>%
  filter(Q5.2_9 != "0") %>%
  rename("Q5.2" = "Q5.2_9")

Q5.2_10 <-
  select(sod2021, Survey, Q5.2_10) %>%
  group_by(Survey) %>%
  count(Q5.2_10) %>%
  filter(Q5.2_10 != "0") %>%
  rename("Q5.2" = "Q5.2_10")

Q5.2_11 <-
  select(sod2021, Survey, Q5.2_11) %>%
  group_by(Survey) %>%
  count(Q5.2_11) %>%
  filter(Q5.2_11 != "0") %>%
  rename("Q5.2" = "Q5.2_11")

Q5.2_12 <-
  select(sod2021, Survey, Q5.2_12) %>%
  group_by(Survey) %>%
  count(Q5.2_12) %>%
  filter(Q5.2_12 != "0") %>%
  rename("Q5.2" = "Q5.2_12")

Q5.2_13 <-
  select(sod2021, Survey, Q5.2_13) %>%
  group_by(Survey) %>%
  count(Q5.2_13) %>%
  filter(Q5.2_13 != "0") %>%
  rename("Q5.2" = "Q5.2_13")

Q5.2_14 <-
  select(sod2021, Survey, Q5.2_14) %>%
  group_by(Survey) %>%
  count(Q5.2_14) %>%
  filter(Q5.2_14 != "0") %>%
  rename("Q5.2" = "Q5.2_14")

Q5.2_15 <-
  select(sod2021, Survey, Q5.2_15) %>%
  group_by(Survey) %>%
  count(Q5.2_15) %>%
  filter(Q5.2_15 != "0") %>%
  rename("Q5.2" = "Q5.2_15")

Q5.2_16 <-
  select(sod2021, Survey, Q5.2_16) %>%
  group_by(Survey) %>%
  count(Q5.2_16) %>%
  filter(Q5.2_16 != "0") %>%
  rename("Q5.2" = "Q5.2_16")

Q5.2_17 <-
  select(sod2021, Survey, Q5.2_17) %>%
  group_by(Survey) %>%
  count(Q5.2_17) %>%
  filter(Q5.2_17 != "0") %>%
  rename("Q5.2" = "Q5.2_17")

Q5.2_18 <-
  select(sod2021, Survey, Q5.2_18) %>%
  group_by(Survey) %>%
  count(Q5.2_18) %>%
  filter(Q5.2_18 != "0") %>%
  rename("Q5.2" = "Q5.2_18")

Q5.2 <- rbind(Q5.2_1, Q5.2_2, Q5.2_3, Q5.2_4, Q5.2_5, Q5.2_6, Q5.2_7, Q5.2_8, Q5.2_9, Q5.2_10, Q5.2_11, Q5.2_12, Q5.2_13, Q5.2_14, Q5.2_15, Q5.2_16, Q5.2_17, Q5.2_18)
rm(Q5.2_1, Q5.2_2, Q5.2_3, Q5.2_4, Q5.2_5, Q5.2_6, Q5.2_7, Q5.2_8, Q5.2_9, Q5.2_10, Q5.2_11, Q5.2_12, Q5.2_13, Q5.2_14, Q5.2_15, Q5.2_16, Q5.2_17, Q5.2_18)

# Keep only valid responses
Q5.2 <- Q5.2 %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q5.2)

Q5.2$Q5.2 <-
  recode_factor(
    Q5.2$Q5.2,
    "Getting proper credit for sharing data" = "Credit",
    "Full data citation" = "Citation, data",                                   
    "Citation of my research papers" = "Citation, paper",                       
    "Co-authorship on papers" = "Co-author",                              
    "Consideration in job reviews and funding applications" = "Job/Funding applications",
    "Journal or Publisher requirement" = "Journal/Publisher requirement",                     
    "Institution or Organisation requirement" = "Institution requirement",              
    "Increased impact and visibility of my research" = "Impact",       
    "Transparency and re-use" = "Reuse",                              
    "Freedom of information request" = "FOI",                       
    "Direct request from another research" = "Requested",                 
    "It was made simple and easy to do" = "Simple to do",                    
    "It was a field/industry expectation" = "Expectation to",                  
    "Other (please specify)" = "Other",                               
    "I would never share my data" = "Won't share"
    )
```
```{r Q5.2 visualisations}
ggplot(Q5.2, aes(x= factor(Survey), y = Pct, fill = Q5.2)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,.2))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q5.2, aes(x= factor(Survey), y = n, fill = Q5.2)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,4000))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q5.2, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q5.2)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q5.2_17 free text, include = FALSE}
Q5.2_17 <-
  sod2021 %>%
  select(Q5.2_17_TEXT) %>%
  subset(Q5.2_17_TEXT != 0) %>%
  drop_na()
Q5.2_17 <-
  unique(Q5.2_17$Q5.2_17_TEXT)
kable(Q5.2_17)
```

**Q5.3 Which one of the circumstances would motivate you the most to share your data?**
```{r Q5.3}
Q5.3 <-
  sod2021 %>%
  select(Survey, Q5.3) %>%
    drop_na()

# Keep only valid responses
Q5.3 <- Q5.3 %>%
  subset(Q5.3 != 0) %>%
    group_by(Survey) %>%
  count(Q5.3, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q5.3)

Q5.3$Q5.3 <-
  recode_factor(
    Q5.3$Q5.3,
    "Getting proper credit for sharing data" = "Credit",
    "Full data citation" = "Citation, data",                                   
    "Citation of my research papers" = "Citation, paper",                       
    "Co-authorship on papers" = "Co-author",                              
    "Consideration in job reviews and funding applications" = "Job/Funding applications",
    "Journal or Publisher requirement" = "Journal/Publisher",                     
    "Institution or Organisation requirement" = "Institution",              
    "Increased impact and visibility of my research" = "Impact",       
    "Transparency and re-use" = "Reuse",                              
    "Freedom of information request" = "FOI",                       
    "Direct request from another research" = "Requested",                 
    "It was made simple and easy to do" = "Simple to do",                    
    "It was a field/industry expectation" = "Expectation to",                  
    "Other (please specify)" = "Other",                               
    "I would never share my data" = "Won't share",
    "Trust the person requesting the data" = "Trust request",
    "Trust the person requesting my data" = "Trust request"
    )
```
```{r Q5.3 visualisations}
ggplot(Q5.3, aes(x= factor(Survey), y = Pct, fill = Q5.3)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,.27))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q5.3, aes(x= factor(Survey), y = n, fill = Q5.3)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,1200))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q5.3, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q5.3)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q5.3_17 free text, include = FALSE}
Q5.3_17 <-
  sod2021 %>%
  select(Q5.3_17_TEXT) %>%
  subset(Q5.3_17_TEXT != 0) %>%
  drop_na()
Q5.3_17 <-
  unique(Q5.3_17$Q5.3_17_TEXT)
kable(Q5.3_17)
```

**Q5.4 If the reuse of your data in a subsequent paper resulted in you being credited as a co-author, how much would this motivate you to make your data openly available to others?**
```{r Q5.4}
Q5.4 <-
  sod2021 %>%
  select(Survey, Q5.4) %>%
    drop_na()

# Keep only valid responses
Q5.4 <- Q5.4 %>%
  subset(Q5.4 != 0) %>%
    group_by(Survey) %>%
  count(Q5.4, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q5.4)

Q5.4$Q5.4 <-
  factor(Q5.4$Q5.4,
         levels = c(
            "A great deal",
            "Very much",
            "Quite a lot",
            "A lot",
            "Somewhat",
            "A moderate amount",
            "A little", 
            "Neutral",
            "Not at all",
            "None at all"
            )
         )
```
```{r Q5.4 visualisations}
ggplot(Q5.4, aes(x= factor(Survey), y = Pct, fill = Q5.4)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,.45))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q5.4, aes(x= factor(Survey), y = n, fill = Q5.4)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,2300))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q5.4, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q5.4)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q5.5 Have you ever received credit/acknowledgement for sharing data?**
```{r Q5.5}
Q5.5 <-
  sod2021 %>%
  select(Survey, Q5.5) %>%
    drop_na()

# Keep only valid responses
Q5.5 <- Q5.5 %>%
  subset(Q5.5 != 0) %>%
    group_by(Survey) %>%
  count(Q5.5, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q5.5)
```
```{r Q5.5 visualisations}
ggplot(Q5.5, aes(x=Survey, y=Pct, fill=Q5.5)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q5.5, aes(x=(Survey), y = n, fill = Q5.5)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +  
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  scale_y_continuous(limits = c(0,3600)) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q5.5, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q5.5)) +
  scale_x_continuous(breaks = 2019:2021) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q5.6 What recognition have you received for sharing your research data?**
```{r Q5.6}
Q5.6_1 <-
  select(sod2021, Survey, Q5.6_1) %>%
  group_by(Survey) %>%
  count(Q5.6_1) %>%
  filter(Q5.6_1 != "0") %>%
  rename("Q5.6" = "Q5.6_1")

Q5.6_2 <-
  select(sod2021, Survey, Q5.6_2) %>%
  group_by(Survey) %>%
  count(Q5.6_2) %>%
  filter(Q5.6_2 != "0") %>%
  rename("Q5.6" = "Q5.6_2")

Q5.6_3 <-
  select(sod2021, Survey, Q5.6_3) %>%
  group_by(Survey) %>%
  count(Q5.6_3) %>%
  filter(Q5.6_3 != "0") %>%
  rename("Q5.6" = "Q5.6_3")

Q5.6_4 <-
  select(sod2021, Survey, Q5.6_4) %>%
  group_by(Survey) %>%
  count(Q5.6_4) %>%
  filter(Q5.6_4 != "0") %>%
  rename("Q5.6" = "Q5.6_4")

Q5.6_5 <-
  select(sod2021, Survey, Q5.6_5) %>%
  group_by(Survey) %>%
  count(Q5.6_5) %>%
  filter(Q5.6_5 != "0") %>%
  rename("Q5.6" = "Q5.6_5")

Q5.6_6 <-
  select(sod2021, Survey, Q5.6_6) %>%
  group_by(Survey) %>%
  count(Q5.6_6) %>%
  filter(Q5.6_6 != "0") %>%
  rename("Q5.6" = "Q5.6_6")

Q5.6_7 <-
  select(sod2021, Survey, Q5.6_7) %>%
  group_by(Survey) %>%
  count(Q5.6_7) %>%
  filter(Q5.6_7 != "0") %>%
  rename("Q5.6" = "Q5.6_7")

Q5.6_8 <-
  select(sod2021, Survey, Q5.6_8) %>%
  group_by(Survey) %>%
  count(Q5.6_8) %>%
  filter(Q5.6_8 != "0") %>%
  rename("Q5.6" = "Q5.6_8")

Q5.6 <- rbind(Q5.6_1, Q5.6_2, Q5.6_3, Q5.6_4, Q5.6_5, Q5.6_6, Q5.6_7, Q5.6_8)
rm(Q5.6_1, Q5.6_2, Q5.6_3, Q5.6_4, Q5.6_5, Q5.6_6, Q5.6_7, Q5.6_8)

# Keep only valid responses
Q5.6 <- 
  Q5.6 %>%
  group_by(Survey) %>%
  mutate(Pct = round(n / sum(n), 3))

kable(Q5.6)

Q5.6$Q5.6 <-
  recode_factor(Q5.6$Q5.6,
                "I don't know" = "Don't know",
                "Full citation in another article"  = "Citation",              
                "Co-authorship on a paper which used my data" = "Co-authorship",
                "Other (please specify)" = "Other",
                "Consideration of actions in a job review" = "Consideration, grant",
                "Consideration of actions in a grant application" = "Consideration, job")
```
```{r Q5.6 visualisations}
ggplot(Q5.6, aes(x= factor(Survey), y = Pct, fill = Q5.6)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,1.2))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q5.6, aes(x= factor(Survey), y = n, fill = Q5.6)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,6000))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q5.6, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q5.6)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q5.6_7 free text, include = FALSE}
Q5.6_7 <-
  sod2021 %>%
  select(Q5.6_7_TEXT) %>%
  subset(Q5.6_7_TEXT != 0) %>%
  drop_na()
Q5.6_7 <-
  unique(Q5.6_7$Q5.6_7_TEXT)
kable(Q5.6_7)
```

**Q5.7 How supportive would you be of a national mandate for making research data openly available?**
```{r Q5.7}
Q5.7 <-
  sod2021 %>%
  select(Survey, Q5.7) %>%
    drop_na()

# Keep only valid responses
Q5.7 <- Q5.7 %>%
  subset(Q5.7 != 0) %>%
    group_by(Survey) %>%
  count(Q5.7, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q5.7)

Q5.7$Q5.7 <-
  factor(Q5.7$Q5.7,
         levels = c(
           "Strongly support",
           "Somewhat support",
           "Neutral",
           "Somewhat oppose",
           "Strongly oppose"
         )
  )
```
```{r Q5.7 visualisations}
ggplot(Q5.7, aes(x=Survey, y=Pct, fill=Q5.7)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  scale_x_continuous(breaks = 2016:2021) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q5.7, aes(x=(Survey), y = n, fill = Q5.7)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +  
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  scale_y_continuous(limits = c(0,3000)) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q5.7, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q5.7)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q5.8 Should funders withhold funding from (or penalise in other ways) researchers who do not share their data if the funder has mandated that they do so at the grant application stage?**
```{r Q5.8}
Q5.8 <-
  sod2021 %>%
  select(Survey, Q5.8) %>%
    drop_na()

# Keep only valid responses
Q5.8 <- Q5.8 %>%
  subset(Q5.8 != 0) %>%
    group_by(Survey) %>%
  count(Q5.8, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q5.8)
```
```{r Q5.8 visualisations}
ggplot(Q5.8, aes(x=Survey, y=Pct, fill=Q5.8)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q5.8, aes(x=(Survey), y = n, fill = Q5.8)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +  
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  scale_y_continuous(limits = c(0,4200)) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q5.8, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q5.8)) +
  xlab("") + ylab("Percentage") +
  scale_x_continuous(breaks = 2019:2021) +
  scale_color_discrete(name="") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q5.9 Should funders make the sharing of research data part of their requirements for awarding grants?**
```{r Q5.9}
Q5.9 <-
  sod2021 %>%
  select(Survey, Q5.9) %>%
    drop_na()

# Keep only valid responses
Q5.9 <- Q5.9 %>%
  subset(Q5.9 != 0) %>%
    group_by(Survey) %>%
  count(Q5.9, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q5.9)
```
```{r Q5.9 visualisations}
ggplot(Q5.9, aes(x=Survey, y=Pct, fill=Q5.9)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q5.9, aes(x=(Survey), y = n, fill = Q5.9)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +  
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  scale_y_continuous(limits = c(0,4200)) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q5.9, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q5.9)) +
  xlab("") + ylab("Percentage") +
  scale_x_continuous(breaks = 2019:2021) +
  scale_color_discrete(name="") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

### Demographics
**Q6.1 About you**
```{r Q6.1}
Q6.1 <-
  sod2021 %>%
  select(Survey, Q6.1) %>%
    drop_na()

# Keep only valid responses
Q6.1 <- Q6.1 %>%
  subset(Q6.1 != 0) %>%
    group_by(Survey) %>%
  count(Q6.1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q6.1)
```
```{r Q6.1 visualisations}
ggplot(Q6.1, aes(x=Survey, y=Pct, fill=Q6.1)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q6.1, aes(x=(Survey), y = n, fill = Q6.1)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +  
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  scale_y_continuous(limits = c(0,3900)) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q6.1, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q6.1)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
```{r Q6.1_7 free text, include = FALSE}
Q6.1_7 <-
  sod2021 %>%
  select(Q6.1_7_TEXT) %>%
  subset(Q6.1_7_TEXT != 0) %>%
  drop_na()
Q6.1_7 <-
  unique(Q6.1_7$Q6.1_7_TEXT)
kable(Q6.1_7)
```

**Q6.4 What is your current tenure status?**
```{r Q6.4}
Q6.4 <-
  sod2021 %>%
  select(Survey, Q6.4) %>%
    drop_na()

# Keep only valid responses
Q6.4 <- Q6.4 %>%
  subset(Q6.4 != 0) %>%
    group_by(Survey) %>%
  count(Q6.4, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q6.4)

Q6.4$Q6.4 <-
  factor(Q6.4$Q6.4,
         levels = c(
           "Tenured",
           "On tenure track but not tenured",
           "No tenure system for my faculty status",
           "No tenure system at my institution/organisation",
           "Not on tenure track"
           )
         )

Q6.4$Q6.4 <-
  recode_factor(Q6.4$Q6.4,
                "No tenure system at my institution/organisation" = "No tenure at inst.",
                "No tenure system for my faculty status" = "No tenure in faculty",
                "On tenure track but not tenured" = "Tenure track")
```
```{r Q6.4 visualisations}
ggplot(Q6.4, aes(x=Survey, y=Pct, fill=Q6.4)) +
  geom_col() +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_stack(vjust = .5),
            size = 3) +
  labs(
    x = NULL,
    y = NULL,
    fill = ""
  ) +
  theme_classic() +
   theme(
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank()
  ) +
  theme(legend.position = "bottom") +
  coord_flip()

ggplot(Q6.4, aes(x=(Survey), y = n, fill = Q6.4)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100),"%", sep = "")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 3) +  
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  scale_y_continuous(limits = c(0,2650)) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
  )

ggplot(Q6.4, aes(x = Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q6.4)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
  scale_x_continuous(breaks = 2019:2021) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

**Q6.5 Which country are you located in?**
```{r Q6.5}
Q6.5 <-
  sod2021 %>%
  select(Survey, Q6.5) %>%
    drop_na()

# Keep only valid responses
Q6.5 <- Q6.5 %>%
  subset(Q6.5 != 0) %>%
    group_by(Survey) %>%
  count(Q6.5, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3))

kable(Q6.5)
```

**Q6.5_1 Which continent are you located in?**
```{r Q6.5_1}
Q6.5_1 <-
  sod2021 %>%
  select(Survey, "6.5_1") %>%
    drop_na()

# Keep only valid responses
Q6.5_1 <- Q6.5_1 %>%
  rename(Q6.5_1 = "6.5_1") %>%
  subset(Q6.5_1 != 0) %>%
    group_by(Survey) %>%
  count(Q6.5_1, sort = TRUE) %>% 
  mutate(Pct = round(n / sum(n), 3)) # Rename column

kable(Q6.5_1)

Q6.5_1$Q6.5_1 <-
  recode_factor(
    Q6.5_1$Q6.5_1,
    "Asia (including Middle East)" = "Asia",
    "North America (including Central America and the Carribean)" = "North America"
    )
```
```{r Q6.5_1 visualisations}
ggplot(Q6.5_1, aes(x= factor(Survey), y = Pct, fill = Q6.5_1)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(round(Pct * 100, digits = 0),"%","\n",n)),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,.45))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q6.5_1, aes(x= factor(Survey), y = n, fill = Q6.5_1)) +
  geom_col(position = position_dodge()) +
  geom_text(aes(label = paste0(n,"\n",round(Pct * 100, digits = 0),"%")),
            position = position_dodge(width = 0.9),
            vjust = -.3,
            size = 2.5) +
  scale_y_continuous(limits = c(0,2300))  +
  labs(
    x = NULL,
    y = NULL,
    caption = "State of Open Data Survey 2021",
    fill = "") +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.line.y = element_blank(),
    axis.text.y = element_blank()
    )

ggplot(Q6.5_1, aes(x= Survey, y = Pct * 100)) +
  geom_line(aes(colour = Q6.5_1)) +
  xlab("") + ylab("Percentage") +
  scale_color_discrete(name="") +
   theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```