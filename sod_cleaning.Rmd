---
title: "State of Open Data"
author: "Laurence Horton"
date: "12/01/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.fullwidth=TRUE, echo = FALSE, warning = FALSE, message = FALSE)
```

## Download data

Research, Nature; Goodey, Greg (2021): State of Open Data Survey 2021 additional resources. figshare. Dataset. https://doi.org/10.6084/m9.figshare.17081231.v1
```{r download 2016-2021 data file}
download.file("https://figshare.com/ndownloader/articles/17081231/versions/1", basename("sod.zip"))
unzip("sod.zip")
```

Remove zip
```{r remove zip file}
unlink("sod.zip", recursive = TRUE)
```

Library
```{r library, include = FALSE}
library(tidyverse)
library(readxl) # For reading in excel files
library(scales) # For graphics breaks and labels
library(knitr) # For tables
```

## Read in data
```{r read in data}
sod <- read_excel("State of Open Data 2021_Master data_cleaned.xlsx")
```

## Clean data
Remove first row that contains column names
```{r remove first row with column names}
sod <- sod[-1,] # remove first row names.
```

ASCII stuff
```{r ASCII}
sod <- as.data.frame(apply(sod, 2, function(sod) gsub("&amp;", "and", sod)))
sod <- as.data.frame(apply(sod, 2, function(sod) gsub("&", "and", sod)))
sod <- as.data.frame(apply(sod, 2, function(sod) gsub("â€™", "'", sod)))
sod <- as.data.frame(apply(sod, 2, function(sod) str_trim(sod)))
```

Standardize responses
```{r Q2.8 Standardise responses}
#Q2.8
sod$Q2.8 <- gsub("data principles", "principles", sod$Q2.8)
sod$Q2.8 <- gsub("I'm", "I am", sod$Q2.8)
sod$Q2.8 <- gsub("I've", "I have", sod$Q2.8)
```

```{r Q3.1 Standardise responses}
#Q3.1
sod$Q3.1 <- gsub("its", "it's", sod$Q3.1)
sod$Q3.1 <- gsub(" ,", ",", sod$Q3.1)
sod$Q3.1 <- gsub("of the data collected", "", sod$Q3.1)
sod$Q3.1 <- gsub(" collected", "", sod$Q3.1)
sod$Q3.1 <- gsub("\\:", "", sod$Q3.1)
sod$Q3.1 <- gsub("we would", "would", sod$Q3.1)
sod$Q3.1 <- gsub("some data", "some", sod$Q3.1)
sod$Q3.1 <- gsub("some ", "some", sod$Q3.1)
```

```{r Q3.6 Standardise responses}
#Q3.6
sod$Q3.6 <- gsub("those no", "not", sod$Q3.6)
sod$Q3.6 <- gsub("ie ", "i.e. ", sod$Q3.6)
sod$Q3.6 <- gsub("My own funds", "Own funds", sod$Q3.6)
sod$Q3.6 <- gsub("Your institution/organisation", "Your institution", sod$Q3.6)
sod$Q3.6 <- gsub("\\(", "", sod$Q3.6)
sod$Q3.6 <- gsub("\\)", "", sod$Q3.6)
sod$Q3.6 <- gsub("Funds identified in your grant for this purpose", "Funds identified in grant for this purpose", sod$Q3.6)
```

```{r Q3.7 Standardise responses}
# Q3.7
sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("Web search", "Web-search", sod))
                                       }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("0Research", "Research", sod))
                                 }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(
                                           gsub(
                                             "Institutional expertise",
                                             "institutional expertise",
                                             sod))
                                       }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("Research office", "	
Research office/In-house institutional expertise", sod))
                                       }))


sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(
                                           gsub(
                                             " \\/ ",
                                             "\\/",
                                             sod))
                                       }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(
                                           gsub(
                                             "In-house Institutional expertise Research office",
                                             "Research office\\/In-house institutional expertise",
                                             sod))
                                       }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(
                                           gsub(
                                             "In-house institutional expertise",
                                             "Research office\\/In-house institutional expertise",
                                             sod))
                                       }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("3rd-party", "3rd party", sod))
                                 }))
sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("party service", "party", sod))
                                 }))
sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("Other \\(please specify\\)", "Other", sod))}))
sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("Institutional Library", "Library", sod))
                                 }))
sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("expertise 0", "expertise", sod))
                                 }))
sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("Colleague/Supervisor", "Colleague", sod))
                                 }))
	
sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("Research office/Research office/In-house institutional expertise/Research office/In-house institutional expertise", "Research office/In-house institutional expertise", sod))
                                 }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("Research office/Research office/In-house institutional expertise", "Research office/In-house institutional expertise", sod))
                                 }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("Research office/In-house institutional expertise 	Research office/Research office/In-house institutional expertise", "Research office/In-house institutional expertise", sod))
                                 }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("\r?\n|\r", "", sod))
                                 }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub("\r?\t|\r", "", sod))
                                 }))

sod[, c(41:51)] <- as.data.frame(apply(sod[, c(41:51)], 2,
                                       function(sod) {
                                         as.character(gsub(" Research office/In-house institutional expertise", "", sod))
                                 }))
```


```{r Q3.10 Standardise responses}
# Q3.10
sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("Contain sensitive information or require permissions before sharing", "Contain sensitive information", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("Contains sensitive information or require study participant permissions before sharing", "Contain sensitive information", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("Unsure about copyright and data licensing", "Unsure about copyright licensing", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("Unsure about copyright and licensing", "Unsure about copyright licensing", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("I do not know what repository to use", "Not know what repository to use", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("Not knowing which repository to use", "Not know what repository to use", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("I am unsure I have permission from my funder or institute to share my data", "Unsure I have the permission to share", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("Unsure I have the rights to share", "Unsure I have the permission to share", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("Concerns about misuse of my data", "Concerns about misuse of data", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("Not receiving appropriate credit or knowledge", "Not receiving appropriate credit or acknowledgement", sod))
                                       }))

sod[, c(65:83)] <- as.data.frame(apply(sod[, c(65:83)], 2,
                                       function(sod) {
                                         as.character(gsub("I have no desire to share data", "I have no desire to share my data", sod))
                                       }))
```

```{r Q3.12 Standardise responses}
# Q3.12
sod[, c(87:94)] <- as.data.frame(apply(sod[, c(87:94)], 2,
                                       function(sod) {
                                         as.character(gsub("Copyright\\/ licensing of data", "Copyright\\/Licensing of data", sod))
                                       }))

sod[, c(87:94)] <- as.data.frame(apply(sod[, c(87:94)], 2,
                                       function(sod) {
                                         as.character(gsub("Copyright\\/Licencing of data", "Copyright\\/Licensing of data", sod))
                                       }))

sod[, c(87:94)] <- as.data.frame(apply(sod[, c(87:94)], 2,
                                       function(sod) {
                                         as.character(gsub("Copyright\\/licensing of data", "Copyright\\/Licensing of data", sod))
                                       }))

sod[, c(87:94)] <- as.data.frame(apply(sod[, c(87:94)], 2,
                                       function(sod) {
                                         as.character(gsub("Creating time to manage activity", "Finding the time to manage my data", sod))
                                       }))

sod[, c(87:94)] <- as.data.frame(apply(sod[, c(87:94)], 2,
                                       function(sod) {
                                         as.character(gsub("Data management plans", "Data Management Plans", sod))
                                       }))
```

```{r Q4.3 standerdise responses}
sod[, c(106:111)] <- as.data.frame(apply(sod[, c(106:111)], 2, function(sod) { as.character(gsub("Avoid duplication of effort", "Avoids duplication of effort", sod))}))

sod[, c(106:111)] <- as.data.frame(apply(sod[, c(106:111)], 2, function(sod) { as.character(gsub("Complement existing data I have collected", "Complement existing data collected", sod))}))

sod[, c(106:111)] <- as.data.frame(apply(sod[, c(106:111)], 2, function(sod) { as.character(gsub("Complements existing data I have collected", "Complement existing data collected", sod))}))

sod[, c(106:111)] <- as.data.frame(apply(sod[, c(106:111)], 2, function(sod) { as.character(gsub("Complements existing data you have collected", "Complement existing data collected", sod))}))

sod[, c(106:111)] <- as.data.frame(apply(sod[, c(106:111)], 2, function(sod) { as.character(gsub("Foster collaboration", "Fosters collaboration", sod))}))

sod[, c(106:111)] <- as.data.frame(apply(sod[, c(106:111)], 2, function(sod) { as.character(gsub("I hasn't/would not benefit me", "It has not or would not benefit me", sod))}))

sod[, c(106:111)] <- as.data.frame(apply(sod[, c(106:111)], 2, function(sod) { as.character(gsub("It hasn't/would not benefit me", "It has not or would not benefit me", sod))}))

sod[, c(106:111)] <- as.data.frame(apply(sod[, c(106:111)], 2, function(sod) {
 as.character(gsub("Validate my own research findings", "Validates own findings", sod))}))

sod[, c(106:111)] <- as.data.frame(apply(sod[, c(106:111)], 2, function(sod) {
 as.character(gsub("Validates my own research findings", "Validates own findings", sod))}))
```

```{r Q5.2 and 5.3 standardise responses}
sod[, c(161:180)] <- as.data.frame(apply(sod[, c(161:180)], 2, function(sod) { as.character(gsub("Direct request from other researcher", "Direct request from another research", sod))}))

sod[, c(161:180)] <- as.data.frame(apply(sod[, c(161:180)], 2, function(sod) { as.character(gsub("Greater transparency and reuse", "Transparency and re-use", sod))}))

sod[, c(161:180)] <- as.data.frame(apply(sod[, c(161:180)], 2, function(sod) { as.character(gsub("Institution\\/organisation requirement", "Institution or Organisation requirement", sod))}))

sod[, c(161:180)] <- as.data.frame(apply(sod[, c(161:180)], 2, function(sod) { as.character(gsub("Institution\\/Organisation requirement", "Institution or Organisation requirement", sod))}))

sod[, c(161:180)] <- as.data.frame(apply(sod[, c(161:180)], 2, function(sod) { as.character(gsub("Institution\\/organization requirement", "Institution or Organisation requirement", sod))}))

sod[, c(161:180)] <- as.data.frame(apply(sod[, c(161:180)], 2,
 function(sod) { as.character(gsub("It was made easy and simple to do so", "It was made simple and easy to do", sod))}))

sod[, c(161:180)] <- as.data.frame(apply(sod[, c(161:180)], 2, function(sod) { as.character(gsub("It was made simple and easy to do so", "It was made simple and easy to do", sod))}))

sod[, c(161:180)] <- as.data.frame(apply(sod[, c(161:180)], 2, function(sod) { as.character(gsub("Journal\\/publisher requirement", "Journal or Publisher requirement", sod))}))

sod[, c(161:180)] <- as.data.frame(apply(sod[, c(161:180)], 2, function(sod) { as.character(gsub("Journal\\/Publisher requirement", "Journal or Publisher requirement", sod))}))
```

```{r Q5.6 standardise responses}
sod[, c(184:191)] <- as.data.frame(apply(sod[, c(184:191)], 2, function(sod) { as.character(gsub("data sharing", "actions", sod))}))

sod[, c(184:191)] <- as.data.frame(apply(sod[, c(184:191)], 2, function(sod) { as.character(gsub("my actions", "actions", sod))}))

sod[, c(184:191)] <- as.data.frame(apply(sod[, c(184:191)], 2, function(sod) { as.character(gsub("Considerations", " Consideration", sod))}))
```

```{r Q6.1 standardise responses}
sod$Q6.1 <- gsub("Government \\/ Local government", "Government\\/Local government", sod$Q6.1)
sod$Q6.1 <- gsub("Government\\/local government", "Government\\/Local government", sod$Q6.1)
sod$Q6.1 <- gsub("Medical School", "Medical school", sod$Q6.1)
sod$Q6.1 <- gsub(":", "", sod$Q6.1)
```

Make survey year numeric
```{r make survey year numeric}
sod$Survey <- as.numeric(as.character(sod$Survey))
sod$Q2.3 <- as.numeric(as.character(sod$Q2.3))
```

### Screener
Q2.1 To provide a little more context for your later responses we would first like to understand a little about your research and attitudes towards open science. When was the last occasion that you published or submitted a manuscript to a journal?
```{r Q2.1}
Q2.1 <-
  sod %>%
  select(Survey, Q2.1) %>%
    drop_na()

Q2.1 <- Q2.1 %>%
    group_by(Survey) %>%
  count(Q2.1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1)))

kable(Q2.1)

# Viz
ggplot(Q2.1, aes(x = Survey, y = n, fill = Q2.1)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "When was the last occasion that you published or submitted a manuscript to a journal?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q2.1, aes(x=(Survey), y = n, fill = Q2.1)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "When was the last occasion that you published or submitted a manuscript to a journal?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q2.3 In which year was your first peer-reviewed research article published?
```{r Q2.3}
Q2.3 <-
  sod %>% count(Q2.3, sort = TRUE) %>%
  subset(Q2.3 > 0) %>%
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%")) # drops year values of 0

kable(Q2.3)

# Viz
ggplot(Q2.3) +
  geom_col(aes(x = Q2.3, y = n)) +
  labs(
    x = "Year",
    y = NULL,
    title = "In which year was your first peer-reviewed research article published?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
  )
```

Q2.4 Which of the following best describes your primary area of interest?
```{r Q2.4}
Q2.4 <-
  sod %>%
  select(Survey, Q2.4) %>%
    drop_na()

Q2.4 <- Q2.4 %>%
  subset(Q2.4 != 0) %>%
    group_by(Survey) %>%
  count(Q2.4, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q2.4)

# Viz
ggplot(Q2.4) +
  geom_col(aes(x = n, y = Q2.4)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Which of the following best describes your primary area of interest?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
 theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
  )
```

Q2.6 Does any of your current research involve collaboration with others? (Please select all that apply)
```{r Q2.6}
# Select all that apply
Q2.6_1 <- select(sod, Survey, Q2.6_1) %>% rename("Q2.6" = "Q2.6_1")
Q2.6_2 <- select(sod, Survey, Q2.6_2) %>% rename("Q2.6" = "Q2.6_2")
Q2.6_3 <- select(sod, Survey, Q2.6_3) %>% rename("Q2.6" = "Q2.6_3")
Q2.6_4 <- select(sod, Survey, Q2.6_4) %>% rename("Q2.6" = "Q2.6_4")
Q2.6_5 <- select(sod, Survey, Q2.6_5) %>% rename("Q2.6" = "Q2.6_5")
Q2.6 <- rbind(Q2.6_1, Q2.6_2, Q2.6_3, Q2.6_4, Q2.6_5)
rm(Q2.6_1, Q2.6_2, Q2.6_3, Q2.6_4, Q2.6_5)

# Keep only valid responses
Q2.6 <- Q2.6 %>%
  subset(Q2.6 != 0) %>%
    group_by(Survey) %>%
  count(Q2.6, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q2.6)

# Viz
ggplot(Q2.6, aes(x=(Survey), y = n, fill = Q2.6)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Does any of your current research involve collaboration with others?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q2.7_1 To what extent do you agree/disagree with the following statements?: 
Making research articles open access should be common scholarly practice
```{r Q2.7_1}
# Keep only valid responses
Q2.7_1 <- sod %>%
  select(Survey, Q2.7_1) %>%
  subset(Q2.7_1 != 0) %>%
    group_by(Survey) %>%
  count(Q2.7_1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

sod$Q2.7_1 <- factor(sod$Q2.7_1, levels = c("Strongly agree", "Somewhat agree", "Neutral", "Somewhat disagree", "Strongly disagree"))

kable(Q2.7_1)

# Viz
ggplot(Q2.7_1) +
  geom_col(aes(x = Q2.7_1, y = n)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Making research articles open access should be common scholarly practice?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q2.7_2 To what extent do you agree/disagree with the following statements?: 
Making research data openly available should be common scholarly practice (2) 
```{r Q2.7_2}
# Keep only valid responses
Q2.7_2 <- sod %>%
  select(Survey, Q2.7_2) %>%
  subset(Q2.7_2 != 0) %>%
    group_by(Survey) %>%
  count(Q2.7_2, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

sod$Q2.7_2 <- factor(sod$Q2.7_2, levels = c("Strongly agree", "Somewhat agree", "Neutral", "Somewhat disagree", "Strongly disagree"))

kable(Q2.7_2)

# Viz
ggplot(Q2.7_2) +
  geom_col(aes(x = Q2.7_2, y = n)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Making research data openly available should be common scholarly practice",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q2.7_3 To what extent do you agree/disagree with the following statements?: 
Making all research outputs openly available should be common scholarly practices (3) 
```{r Q2.7_3}
# Keep only valid responses
Q2.7_3 <- sod %>%
  select(Survey, Q2.7_3) %>%
  subset(Q2.7_3 != 0) %>%
    group_by(Survey) %>%
  count(Q2.7_3, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

sod$Q2.7_3 <- factor(sod$Q2.7_3, levels = c("Strongly agree", "Somewhat agree", "Neutral", "Somewhat disagree", "Strongly disagree"))

kable(Q2.7_3)

# Viz
ggplot(Q2.7_3) +
  geom_col(aes(x = Q2.7_3, y = n)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Making all research outputs openly available should be common scholarly practices",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q2.8 How familiar are you with the FAIR data principles in relation to open data?
```{r Q2.8}
Q2.8 <-
  sod %>%
  select(Survey, Q2.8) %>%
    drop_na()

Q2.8 <- Q2.8 %>%
    subset(Q2.8 != 0) %>%
    group_by(Survey) %>%
  count(Q2.8, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q2.8)

# Viz
ggplot(Q2.8, aes(x = Survey, y = n, fill = Q2.8)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How familiar are you with the FAIR data principles in relation to open data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q2.8, aes(x=(Survey), y = n, fill = Q2.8)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How familiar are you with the FAIR data principles in relation to open data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

### Data Sharing Practices
Q3.1 About your research data. Do you curate/prepare your data for sharing during or shortly after the data collection process either privately or publicly?
```{r Q3.1}
Q3.1 <-
  sod %>%
  select(Survey, Q3.1) %>%
    drop_na()

Q3.1 <- Q3.1 %>%
    subset(Q3.1 != 0) %>%
    group_by(Survey) %>%
  count(Q3.1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.1)

# Viz
ggplot(Q3.1, aes(x = Survey, y = n, fill = Q3.1)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "About your research data. Do you curate/prepare your data for sharing during or shortly after the data collection process either privately or publicly?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q3.1, aes(x=(Survey), y = n, fill = Q3.1)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "About your research data. Do you curate/prepare your data for sharing during or shortly after the data collection process either privately or publicly?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.2 Have you created a data management plan for your current research? (Please select all that apply)
```{r Q3.2}
# Select all that apply
Q3.2_1 <- select(sod, Survey, Q3.2_1) %>% rename("Q3.2" = "Q3.2_1")
Q3.2_2 <- select(sod, Survey, Q3.2_2) %>% rename("Q3.2" = "Q3.2_2")
Q3.2_3 <- select(sod, Survey, Q3.2_3) %>% rename("Q3.2" = "Q3.2_3")
Q3.2_4 <- select(sod, Survey, Q3.2_4) %>% rename("Q3.2" = "Q3.2_4")
Q3.2_5 <- select(sod, Survey, Q3.2_5) %>% rename("Q3.2" = "Q3.2_5")
Q3.2 <- rbind(Q3.2_1, Q3.2_2, Q3.2_3, Q3.2_4, Q3.2_5)
rm(Q3.2_1, Q3.2_2, Q3.2_3, Q3.2_4, Q3.2_5)

# Keep only valid responses
Q3.2 <- Q3.2 %>%
  subset(Q3.2 != 0) %>%
    group_by(Survey) %>%
  count(Q3.2, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.2)

# Viz
ggplot(Q3.2) +
  geom_col(aes(x = n, y = Q3.2)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Have you created a data management plan for your current research?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.3 At which point during the research cycle, if at all, do you make your data available?
```{r Q3.3}
# Keep only valid responses
Q3.3 <-
  sod %>%
  select(Survey, Q3.3) %>%
    drop_na()

Q3.3 <- Q3.3 %>%
  subset(Q3.3 != 0) %>%
    group_by(Survey) %>%
  count(Q3.3, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.3)

# Viz
ggplot(Q3.3) +
  geom_col(aes(x = n, y = Q3.3)) +
  labs(
    x = NULL,
    y = NULL,
    title = "At which point during the research cycle, if at all, do you make your data available?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.4 How do you share your research data with a public audience? (Please select all that apply) 
```{r Q3.4}
# Select all that apply
Q3.4_1 <- select(sod, Survey, Q3.4_1) %>% rename("Q3.4" = "Q3.4_1")
Q3.4_2 <- select(sod, Survey, Q3.4_2) %>% rename("Q3.4" = "Q3.4_2")
Q3.4_3 <- select(sod, Survey, Q3.4_3) %>% rename("Q3.4" = "Q3.4_3")
Q3.4_4 <- select(sod, Survey, Q3.4_4) %>% rename("Q3.4" = "Q3.4_4")
Q3.4_5 <- select(sod, Survey, Q3.4_5) %>% rename("Q3.4" = "Q3.4_5")
Q3.4_6 <- select(sod, Survey, Q3.4_6) %>% rename("Q3.4" = "Q3.4_6")
Q3.4 <- rbind(Q3.4_1, Q3.4_2, Q3.4_3, Q3.4_4, Q3.4_5, Q3.4_6)
rm(Q3.4_1, Q3.4_2, Q3.4_3, Q3.4_4, Q3.4_5, Q3.4_6)

# Keep only valid responses
Q3.4 <- Q3.4 %>%
  subset(Q3.4 != 0) %>%
    group_by(Survey) %>%
  count(Q3.4, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.4)

# Viz
ggplot(Q3.4) +
  geom_col(aes(x = n, y = Q3.4)) +
  labs(
    x = NULL,
    y = NULL,
    title = "How do you share your research data with a public audience?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.5 To what extent do you think you make your data open in compliance with FAIR?
```{r Q3.5}
# Keep only valid responses
Q3.5 <-
  sod %>%
  select(Survey, Q3.5) %>%
    drop_na()

Q3.5 <- Q3.5 %>%
    subset(Q3.5 != 0) %>%
    group_by(Survey) %>%
  count(Q3.5, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q3.5$Q3.5 <- factor(Q3.5$Q3.5, levels = c("I don't know", "Not at all", "Not very much", "Neutral", "Somewhat", "Very much"))

kable(Q3.5)

# Viz
ggplot(Q3.5, aes(x = Survey, y = n, fill = Q3.5)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent do you think you make your data open in compliance with FAIR?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q3.5, aes(x=(Survey), y = n, fill = Q3.5)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent do you think you make your data open in compliance with FAIR?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.6 Do you know who meets the costs of making your research data openly accessible (e.g. resource for curation)?
```{r Q3.6}
# Keep only valid responses
Q3.6 <-
  sod %>%
  select(Survey, Q3.6) %>%
    drop_na()

Q3.6 <- Q3.6 %>%
    subset(Q3.6 != 0) %>%
    group_by(Survey) %>%
  count(Q3.6, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.6)

# Viz
ggplot(Q3.6, aes(x = Survey, y = n, fill = Q3.6)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Do you know who meets the costs of making your research data openly accessible (e.g. resource for curation)?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q3.6, aes(x=(Survey), y = n, fill = Q3.6)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "About your research data. Do you curate/prepare your data for sharing during or shortly after the data collection process either privately or publicly?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.7 If you required help in making your research data openly available, which sources would you rely upon? (Please select all that apply)
```{r Q3.7}
# Select all that apply
Q3.7_1 <- select(sod, Survey, Q3.7_1) %>% rename("Q3.7" = "Q3.7_1")
Q3.7_2 <- select(sod, Survey, Q3.7_2) %>% rename("Q3.7" = "Q3.7_2")
Q3.7_3 <- select(sod, Survey, Q3.7_3) %>% rename("Q3.7" = "Q3.7_3")
Q3.7_4 <- select(sod, Survey, Q3.7_4) %>% rename("Q3.7" = "Q3.7_4")
Q3.7_5 <- select(sod, Survey, Q3.7_5) %>% rename("Q3.7" = "Q3.7_5")
Q3.7_6 <- select(sod, Survey, Q3.7_6) %>% rename("Q3.7" = "Q3.7_6")
Q3.7_7 <- select(sod, Survey, Q3.7_7) %>% rename("Q3.7" = "Q3.7_7")
Q3.7_8 <- select(sod, Survey, Q3.7_8) %>% rename("Q3.7" = "Q3.7_8")
Q3.7_9 <- select(sod, Survey, Q3.7_9) %>% rename("Q3.7" = "Q3.7_9")
Q3.7_10 <- select(sod, Survey, Q3.7_10) %>% rename("Q3.7" = "Q3.7_10")
Q3.7_11 <- select(sod, Survey, Q3.7_11) %>% rename("Q3.7" = "Q3.7_11")
Q3.7 <- rbind(Q3.7_1, Q3.7_2, Q3.7_3, Q3.7_4, Q3.7_5, Q3.7_6, Q3.7_7, Q3.7_8, Q3.7_9, Q3.7_10, Q3.7_11)
rm(Q3.7_1, Q3.7_2, Q3.7_3, Q3.7_4, Q3.7_5, Q3.7_6, Q3.7_7, Q3.7_8, Q3.7_9, Q3.7_10, Q3.7_11)

# Keep only valid responses
Q3.7 <- Q3.7 %>%
 subset(!(Q3.7 %in% c(0, "00"))) %>%
  drop_na() %>%
    group_by(Survey) %>%
  count(Q3.7, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.7)

# Viz
ggplot(Q3.7, aes(x = Survey, y = n, fill = Q3.7)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "If you required help in making your research data openly available, which sources would you rely upon?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q3.7, aes(x=(Survey), y = n, fill = Q3.7)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "If you required help in making your research data openly available, which sources would you rely upon?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.8 How, if at all, do you monitor the use of data that you share publicly? (Please select all that apply)
```{r Q3.8}
# Select all that apply
Q3.8_1 <- select(sod, Survey, Q3.8_1) %>% rename("Q3.8" = "Q3.8_1")
Q3.8_2 <- select(sod, Survey, Q3.8_2) %>% rename("Q3.8" = "Q3.8_2")
Q3.8_3 <- select(sod, Survey, Q3.8_3) %>% rename("Q3.8" = "Q3.8_3")
Q3.8_4 <- select(sod, Survey, Q3.8_4) %>% rename("Q3.8" = "Q3.8_4")
Q3.8_5 <- select(sod, Survey, Q3.8_5) %>% rename("Q3.8" = "Q3.8_5")
Q3.8_6 <- select(sod, Survey, Q3.8_6) %>% rename("Q3.8" = "Q3.8_6")
Q3.8 <- rbind(Q3.8_1, Q3.8_2, Q3.8_3, Q3.8_4, Q3.8_5, Q3.8_6)
rm(Q3.8_1, Q3.8_2, Q3.8_3, Q3.8_4, Q3.8_5, Q3.8_6)

# Keep only valid responses
Q3.8 <- Q3.8 %>%
  subset(Q3.8 != 0) %>%
    group_by(Survey) %>%
  count(Q3.8, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.8)

# Viz
ggplot(Q3.8) +
  geom_col(aes(x = n, y = Q3.8)) +
  labs(
    x = NULL,
    y = NULL,
    title = "How, if at all, do you monitor the use of data that you share publicly?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.9 To what extent are you comfortable with others using your data for the following?:
Q3.9_1 Replication studies (use of your data as a reference to determine whether they can be repeated under similar conditions)
```{r Q3.9_1}
Q3.9_1 <-
  sod %>%
  select(Survey, Q3.9_1) %>%
    drop_na()

Q3.9_1 <- Q3.9_1 %>%
  subset(Q3.9_1 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q3.9_1$Q3.9_1 <- factor(Q3.9_1$Q3.9_1, levels = c("Extremely comfortable",	"Somewhat comfortable", "Neutral", "Somewhat uncomfortable", "Extremely uncomfortable", "I don't know"))

kable(Q3.9_1)

# Viz
ggplot(Q3.9_1) +
  geom_col(aes(x = n, y = Q3.9_1)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Replication studies (use of your data as a reference to determine whether they can be repeated under similar conditions)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.9_2 Reanalysis (using a different method to analyse your data set)
```{r Q3.9_2}
Q3.9_2 <-
  sod %>%
  select(Survey, Q3.9_2) %>%
    drop_na()

Q3.9_2 <- Q3.9_2 %>%
  subset(Q3.9_2 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_2, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q3.9_2$Q3.9_2 <- factor(Q3.9_2$Q3.9_2, levels = c("Extremely comfortable",	"Somewhat comfortable", "Neutral", "Somewhat uncomfortable", "Extremely uncomfortable", "I don't know"))

kable(Q3.9_2)

# Viz
ggplot(Q3.9_2) +
  geom_col(aes(x = n, y = Q3.9_2)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Reanalysis (using a different method to analyse your data set)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.9_3 Reinterpretation (using your data as is to answer another question)
```{r Q3.9_3}
Q3.9_3 <-
  sod %>%
  select(Survey, Q3.9_3) %>%
    drop_na()

Q3.9_3 <- Q3.9_3 %>%
  subset(Q3.9_3 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_3, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q3.9_3$Q3.9_3 <- factor(Q3.9_3$Q3.9_3, levels = c("Extremely comfortable",	"Somewhat comfortable", "Neutral", "Somewhat uncomfortable", "Extremely uncomfortable", "I don't know"))

kable(Q3.9_3)

# Viz
ggplot(Q3.9_3) +
  geom_col(aes(x = n, y = Q3.9_3)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Reinterpretation (using your data as is to answer another question)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.9_4 Isolated reuse (reanalysing your data to answer a new question)
```{r Q3.9_4}
Q3.9_4 <-
  sod %>%
  select(Survey, Q3.9_4) %>%
    drop_na()

Q3.9_4 <- Q3.9_4 %>%
  subset(Q3.9_4 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_4, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q3.9_4$Q3.9_4 <- factor(Q3.9_4$Q3.9_4, levels = c("Extremely comfortable",	"Somewhat comfortable", "Neutral", "Somewhat uncomfortable", "Extremely uncomfortable", "I don't know"))

kable(Q3.9_4)

# Viz
ggplot(Q3.9_4) +
  geom_col(aes(x = n, y = Q3.9_4)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Isolated reuse (reanalysing your data to answer a new question)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.9_5 Combination reuse (reanalysing your data in combination with other data sets to answer a new question)
```{r Q3.9_5}
Q3.9_5 <-
  sod %>%
  select(Survey, Q3.9_5) %>%
    drop_na()

Q3.9_5 <- Q3.9_5 %>%
  subset(Q3.9_5 != 0) %>%
    group_by(Survey) %>%
  count(Q3.9_5, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q3.9_5$Q3.9_5 <- factor(Q3.9_5$Q3.9_5, levels = c("Extremely comfortable",	"Somewhat comfortable", "Neutral", "Somewhat uncomfortable", "Extremely uncomfortable", "I don't know"))

kable(Q3.9_5)

# Viz
ggplot(Q3.9_5) +
  geom_col(aes(x = n, y = Q3.9_5)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Combination reuse (reanalysing your data in combination with other data sets to answer a new question)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.10 What problems/concerns, if any, do you have with sharing datasets? (Please select all that apply)
```{r Q3.10}
# Select all that apply
Q3.10_1 <- select(sod, Survey, Q3.10_1) %>% rename("Q3.10" = "Q3.10_1")
Q3.10_2 <- select(sod, Survey, Q3.10_2) %>% rename("Q3.10" = "Q3.10_2")
Q3.10_3 <- select(sod, Survey, Q3.10_3) %>% rename("Q3.10" = "Q3.10_3")
Q3.10_4 <- select(sod, Survey, Q3.10_4) %>% rename("Q3.10" = "Q3.10_4")
Q3.10_5 <- select(sod, Survey, Q3.10_5) %>% rename("Q3.10" = "Q3.10_5")
Q3.10_6 <- select(sod, Survey, Q3.10_6) %>% rename("Q3.10" = "Q3.10_6")
Q3.10_7 <- select(sod, Survey, Q3.10_7) %>% rename("Q3.10" = "Q3.10_7")
Q3.10_8 <- select(sod, Survey, Q3.10_8) %>% rename("Q3.10" = "Q3.10_8")
Q3.10_9 <- select(sod, Survey, Q3.10_9) %>% rename("Q3.10" = "Q3.10_9")
Q3.10_10 <- select(sod, Survey, Q3.10_10) %>% rename("Q3.10" = "Q3.10_10")
Q3.10_11 <- select(sod, Survey, Q3.10_11) %>% rename("Q3.10" = "Q3.10_11")
Q3.10_12 <- select(sod, Survey, Q3.10_12) %>% rename("Q3.10" = "Q3.10_12")
Q3.10_13 <- select(sod, Survey, Q3.10_13) %>% rename("Q3.10" = "Q3.10_13")
Q3.10_14 <- select(sod, Survey, Q3.10_14) %>% rename("Q3.10" = "Q3.10_14")
Q3.10_15 <- select(sod, Survey, Q3.10_15) %>% rename("Q3.10" = "Q3.10_15")
Q3.10_16 <- select(sod, Survey, Q3.10_16) %>% rename("Q3.10" = "Q3.10_16")
Q3.10_17 <- select(sod, Survey, Q3.10_17) %>% rename("Q3.10" = "Q3.10_17")
Q3.10_18 <- select(sod, Survey, Q3.10_18) %>% rename("Q3.10" = "Q3.10_18")
Q3.10_19 <- select(sod, Survey, Q3.10_19) %>% rename("Q3.10" = "Q3.10_19")

Q3.10 <- rbind(Q3.10_1, Q3.10_2, Q3.10_3, Q3.10_4, Q3.10_5, Q3.10_6, Q3.10_7, Q3.10_8, Q3.10_9, Q3.10_10, Q3.10_11, Q3.10_12, Q3.10_13, Q3.10_14, Q3.10_15, Q3.10_16, Q3.10_17, Q3.10_18, Q3.10_19)
rm(Q3.10_1, Q3.10_2, Q3.10_3, Q3.10_4, Q3.10_5, Q3.10_6, Q3.10_7, Q3.10_8, Q3.10_9, Q3.10_10, Q3.10_11, Q3.10_12, Q3.10_13, Q3.10_14, Q3.10_15, Q3.10_16, Q3.10_17, Q3.10_18, Q3.10_19)

# Keep only valid responses
Q3.10 <- Q3.10 %>%
  subset(Q3.10 != 0) %>%
    group_by(Survey) %>%
  count(Q3.10, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.10)

# Viz
ggplot(Q3.10, aes(x = Survey, y = n, fill = Q3.10)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What problems/concerns, if any, do you have with sharing datasets?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q3.10, aes(x=(Survey), y = n, fill = Q3.10)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What problems/concerns, if any, do you have with sharing datasets?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q3.11 Have you ever been involved in a collaboration as a result of data you have previously shared?
```{r Q3.11}
Q3.11 <-
  sod %>%
  select(Survey, Q3.11) %>%
    drop_na()

Q3.11 <- Q3.11 %>%
  subset(Q3.11 != 0) %>%
    group_by(Survey) %>%
  count(Q3.11, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.11)

# Viz
ggplot(Q3.11) +
  geom_col(aes(x = n, y = Q3.11)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Have you ever been involved in a collaboration as a result of data you have previously shared?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)

```

Q52 Have you ever been 'scooped' (i.e. have another lab publish an result similar to your own before you do) as a result of data you have previously shared?
```{r Q52}
Q52 <-
  sod %>%
  select(Survey, Q52) %>%
    drop_na()

# Keep only valid responses
Q52 <- Q52 %>%
  subset(Q52 != 0) %>%
  drop_na() %>%
    group_by(Survey) %>%
  count(Q52, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q52)

# Viz
ggplot(Q3.11) +
  geom_col(aes(x = n, y = Q3.11)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Have you ever been 'scooped' (i.e. have another lab publish an result similar to your own before you do) as a result of data you have previously shared?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```


Q3.12 What areas, if any, do you feel you need help with in regard to making your research data openly available? (Please select all that apply)
```{r Q3.12}
Q3.12_1 <- select(sod, Survey, Q3.12_1) %>% rename("Q3.12" = "Q3.12_1")
Q3.12_2 <- select(sod, Survey, Q3.12_2) %>% rename("Q3.12" = "Q3.12_2")
Q3.12_3 <- select(sod, Survey, Q3.12_3) %>% rename("Q3.12" = "Q3.12_3")
Q3.12_4 <- select(sod, Survey, Q3.12_4) %>% rename("Q3.12" = "Q3.12_4")
Q3.12_5 <- select(sod, Survey, Q3.12_5) %>% rename("Q3.12" = "Q3.12_5")
Q3.12_6 <- select(sod, Survey, Q3.12_6) %>% rename("Q3.12" = "Q3.12_6")
Q3.12_7 <- select(sod, Survey, Q3.12_7) %>% rename("Q3.12" = "Q3.12_7")
Q3.12_8 <- select(sod, Survey, Q3.12_8) %>% rename("Q3.12" = "Q3.12_8")

Q3.12 <- rbind(Q3.12_1, Q3.12_2, Q3.12_3, Q3.12_4, Q3.12_5, Q3.12_6, Q3.12_7, Q3.12_8)
rm(Q3.12_1, Q3.12_2, Q3.12_3, Q3.12_4, Q3.12_5, Q3.12_6, Q3.12_7, Q3.12_8)

# Keep only valid responses
Q3.12 <- Q3.12 %>%
  subset(Q3.12 != 0) %>%
    group_by(Survey) %>%
  count(Q3.12, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.12)

# Viz
ggplot(Q3.12, aes(x = Survey, y = n, fill = Q3.12)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What problems/concerns, if any, do you have with sharing datasets?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q3.12, aes(x=(Survey), y = n, fill = Q3.12)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What problems/concerns, if any, do you have with sharing datasets?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)

```

Q3.13 Would you like more guidance on how to comply with the policies of any of the below on making your research data openly available? (Please select all that apply)
```{r Q3.13}
Q3.13_1 <- select(sod, Survey, Q3.13_1) %>% rename("Q3.13" = "Q3.13_1")
Q3.13_2 <- select(sod, Survey, Q3.13_2) %>% rename("Q3.13" = "Q3.13_2")
Q3.13_3 <- select(sod, Survey, Q3.13_3) %>% rename("Q3.13" = "Q3.13_3")
Q3.13_4 <- select(sod, Survey, Q3.13_4) %>% rename("Q3.13" = "Q3.13_4")
Q3.13_5 <- select(sod, Survey, Q3.13_5) %>% rename("Q3.13" = "Q3.13_5")

Q3.13 <- rbind(Q3.13_1, Q3.13_2, Q3.13_3, Q3.13_4, Q3.13_5)
rm(Q3.13_1, Q3.13_2, Q3.13_3, Q3.13_4, Q3.13_5)

# Keep only valid responses
Q3.13 <- Q3.13 %>%
  subset(Q3.13 != 0) %>%
    group_by(Survey) %>%
  count(Q3.13, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q3.13)

# Viz
ggplot(Q3.13) +
  geom_col(aes(x = n, y = Q3.13)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Would you like more guidance on how to comply with the policies of any of the below on making your research data openly available?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```


### Data reuse practices
Q4.1 About your usage of other data sources, Since January 2020, have you reused any of the below as part of your research?: (Please select all that apply) [Note: by 'reuse' we mean undertaking new analysis of a pre-existing data set, either on its own or to add to another data set, to answer a different research question to that which the collection of data was originally intended]
```{r Q4.1}
Q4.1_1 <- select(sod, Survey, Q4.1_1) %>% rename("Q4.1" = "Q4.1_1")
Q4.1_2 <- select(sod, Survey, Q4.1_2) %>% rename("Q4.1" = "Q4.1_2")
Q4.1_3 <- select(sod, Survey, Q4.1_3) %>% rename("Q4.1" = "Q4.1_3")

Q4.1 <- rbind(Q4.1_1, Q4.1_2, Q4.1_3)
rm(Q4.1_1, Q4.1_2, Q4.1_3)

# Include all responses
Q4.1 <- Q4.1 %>%
    group_by(Survey) %>%
  count(Q4.1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.1)

# Viz
ggplot(Q4.1, aes(x = Survey, y = n, fill = Q4.1)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "About your usage of other data sources, Since January 2020, have you reused any of the below as part of your research?: (Please select all that apply)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.1, aes(x=(Survey), y = n, fill = Q4.1)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "About your usage of other data sources, Since January 2020, have you reused any of the below as part of your research?: (Please select all that apply)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)

```

Q4.2 To what extent has the COVID-19 pandemic affected your reuse of data?
Q4.2_1 Your own data (1) 
```{r Q4.2_1}
Q4.2_1 <-
  sod %>%
  select(Survey, Q4.2_1) %>%
    drop_na()

# Keep only valid responses
Q4.2_1 <- Q4.2_1 %>%
    group_by(Survey) %>%
    subset(Q4.2_1 != 0) %>%
  count(Q4.2_1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.2_1)

# Viz
ggplot(Q4.2_1, aes(x = "", y = n, fill = Q4.2_1)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent has the COVID-19 pandemic affected your reuse of data?
Your own data",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.2_1, aes(x = n, y = Q4.2_1)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent has the COVID-19 pandemic affected your reuse of data?
Your own data",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
  )

```

Q4.2_2 Openly accessible data shared by other research groups (2) 
```{r Q4.2_2}
Q4.2_2 <-
  sod %>%
  select(Survey, Q4.2_2) %>%
    drop_na()

# Keep only valid responses
Q4.2_2 <- Q4.2_2 %>%
    group_by(Survey) %>%
    subset(Q4.2_2 != 0) %>%
  count(Q4.2_2, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.2_2)

# Viz
ggplot(Q4.2_2, aes(x = "", y = n, fill = Q4.2_2)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent has the COVID-19 pandemic affected your reuse of data?
Openly accessible data shared by other research groups",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
        axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.2_2, aes(x = n, y = Q4.2_2)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent has the COVID-19 pandemic affected your reuse of data?
Openly accessible data shared by other research groups",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
  )
```

Q4.3 How do you think the data shared by others has or could benefit you? (Please select all that apply)
```{r Q4.3}
Q4.3_1 <- select(sod, Survey, Q4.3_1) %>% rename("Q4.3" = "Q4.3_1")
Q4.3_2 <- select(sod, Survey, Q4.3_2) %>% rename("Q4.3" = "Q4.3_2")
Q4.3_3 <- select(sod, Survey, Q4.3_3) %>% rename("Q4.3" = "Q4.3_3")
Q4.3_4 <- select(sod, Survey, Q4.3_4) %>% rename("Q4.3" = "Q4.3_4")
Q4.3_5 <- select(sod, Survey, Q4.3_5) %>% rename("Q4.3" = "Q4.3_5")
Q4.3_6 <- select(sod, Survey, Q4.3_6) %>% rename("Q4.3" = "Q4.3_6")

Q4.3 <- rbind(Q4.3_1, Q4.3_2, Q4.3_3, Q4.3_4, Q4.3_5, Q4.3_6)
rm(Q4.3_1, Q4.3_2, Q4.3_3, Q4.3_4, Q4.3_5, Q4.3_6)

# Keep only valid responses
Q4.3 <- Q4.3 %>%
    group_by(Survey) %>%
    subset(Q4.3 != 0) %>%
  count(Q4.3, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.3)

# Viz
ggplot(Q4.3, aes(x = Survey, y = n, fill = Q4.3)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How do you think the data shared by others has or could benefit you?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.3, aes(x=(Survey), y = n, fill = Q4.3)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How do you think the data shared by others has or could benefit you?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.4 Where have you previously obtained research data which has been collected by other research groups, for your own reuse? (Please select all that apply)
```{r Q4.4}
Q4.4_1 <- select(sod, Survey, Q4.4_1) %>% rename("Q4.4" = "Q4.4_1")
Q4.4_2 <- select(sod, Survey, Q4.4_2) %>% rename("Q4.4" = "Q4.4_2")
Q4.4_3 <- select(sod, Survey, Q4.4_3) %>% rename("Q4.4" = "Q4.4_3")
Q4.4_4 <- select(sod, Survey, Q4.4_4) %>% rename("Q4.4" = "Q4.4_4")
Q4.4_5 <- select(sod, Survey, Q4.4_5) %>% rename("Q4.4" = "Q4.4_5")
Q4.4_6 <- select(sod, Survey, Q4.4_6) %>% rename("Q4.4" = "Q4.4_6")

Q4.4 <- rbind(Q4.4_1, Q4.4_2, Q4.4_3, Q4.4_4, Q4.4_5, Q4.4_6)
rm(Q4.4_1, Q4.4_2, Q4.4_3, Q4.4_4, Q4.4_5, Q4.4_6)

# Keep only valid responses
Q4.4 <- Q4.4 %>%
    group_by(Survey) %>%
    subset(Q4.4 != 0) %>%
  count(Q4.4, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.4)

# Viz
ggplot(Q4.4, aes(x = "", y = n, fill = Q4.4)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Where have you previously obtained research data which has been collected by other research groups, for your own reuse?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.4, aes(x = n, y = Q4.4)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Where have you previously obtained research data which has been collected by other research groups, for your own reuse?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```
Q4.5 What was your aim in using previously generated data? (Please select all that apply)
```{r Q4.5}
Q4.5_1 <- select(sod, Survey, Q4.5_1) %>% rename("Q4.5" = "Q4.5_1")
Q4.5_2 <- select(sod, Survey, Q4.5_2) %>% rename("Q4.5" = "Q4.5_2")
Q4.5_3 <- select(sod, Survey, Q4.5_3) %>% rename("Q4.5" = "Q4.5_3")
Q4.5_4 <- select(sod, Survey, Q4.5_4) %>% rename("Q4.5" = "Q4.5_4")
Q4.5_5 <- select(sod, Survey, Q4.5_5) %>% rename("Q4.5" = "Q4.5_5")
Q4.5_6 <- select(sod, Survey, Q4.5_6) %>% rename("Q4.5" = "Q4.5_6")

Q4.5 <- rbind(Q4.5_1, Q4.5_2, Q4.5_3, Q4.5_4, Q4.5_5, Q4.5_6)
rm(Q4.5_1, Q4.5_2, Q4.5_3, Q4.5_4, Q4.5_5, Q4.5_6)

# Keep only valid responses
Q4.5 <- Q4.5 %>%
    group_by(Survey) %>%
    subset(Q4.5 != 0) %>%
  count(Q4.5, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.5)

# Viz
ggplot(Q4.5, aes(x = "", y = n, fill = Q4.5)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Where have you previously obtained research data which has been collected by other research groups, for your own reuse?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.5, aes(x = n, y = Q4.5)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Where have you previously obtained research data which has been collected by other research groups, for your own reuse?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6 How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set? Extremely important (1)	Somewhat important (2)	Moderately important (3)	Slightly important (4)	Not at all important (5)	I don't know (6)

Q4.6_1 The data are available from a publicly available repository (1)
```{r Q4.6_1}
Q4.6_1 <-
  sod %>%
  select(Survey, Q4.6_1) %>%
    drop_na()

# Keep only valid responses
Q4.6_1 <- Q4.6_1 %>%
    group_by(Survey) %>%
    subset(Q4.6_1 != 0) %>%
  count(Q4.6_1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_1$Q4.6_1 <- factor(Q4.6_1$Q4.6_1, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_1)

# Viz
ggplot(Q4.6_1, aes(x = "", y = n, fill = Q4.6_1)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "The data are available from a publicly available repository",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_1, aes(x = n, y = Q4.6_1)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "The data are available from a publicly available repository",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_2 The data are new (e.g. released within the last year) (2) 
```{r Q4.6_2}
Q4.6_2 <-
  sod %>%
  select(Survey, Q4.6_2) %>%
    drop_na()

# Keep only valid responses
Q4.6_2 <- Q4.6_2 %>%
    group_by(Survey) %>%
    subset(Q4.6_2 != 0) %>%
  count(Q4.6_2, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_2$Q4.6_2 <- factor(Q4.6_2$Q4.6_2, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_2)

# Viz
ggplot(Q4.6_2, aes(x = "", y = n, fill = Q4.6_2)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "The data are new (e.g. released within the last year)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_2, aes(x = n, y = Q4.6_2)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "The data are new (e.g. released within the last year)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_3 The data can be viewed, downloaded and edited on an application I have available (3) 
```{r Q4.6_3}
Q4.6_3 <-
  sod %>%
  select(Survey, Q4.6_3) %>%
    drop_na()

# Keep only valid responses
Q4.6_3 <- Q4.6_3 %>%
    group_by(Survey) %>%
    subset(Q4.6_3 != 0) %>%
  count(Q4.6_3, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_3$Q4.6_3 <- factor(Q4.6_3$Q4.6_3, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_3)

# Viz
ggplot(Q4.6_3, aes(x = "", y = n, fill = Q4.6_3)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "The data can be viewed, downloaded and edited on an application I have available",
    subtitle = "The data are available from a publicly available repository ",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_3, aes(x = n, y = Q4.6_3)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "The data can be viewed, downloaded and edited on an application I have available",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_4 The data come from a known source (e.g. familiar institution or academic) (4) 
```{r Q4.6_4}
Q4.6_4 <-
  sod %>%
  select(Survey, Q4.6_4) %>%
    drop_na()

# Keep only valid responses
Q4.6_4 <- Q4.6_4 %>%
    group_by(Survey) %>%
    subset(Q4.6_4 != 0) %>%
  count(Q4.6_4, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_4$Q4.6_4 <- factor(Q4.6_4$Q4.6_4, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_4)

# Viz
ggplot(Q4.6_4, aes(x = "", y = n, fill = Q4.6_4)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "The data come from a known source (e.g. familiar institution or academic)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_4, aes(x = n, y = Q4.6_4)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "The data come from a known source (e.g. familiar institution or academic)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_5 The data are in a repository that I know checks/curates the data (5) 
```{r Q4.6_5}
Q4.6_5 <-
  sod %>%
  select(Survey, Q4.6_5) %>%
    drop_na()

# Keep only valid responses
Q4.6_5 <- Q4.6_5 %>%
    group_by(Survey) %>%
    subset(Q4.6_5 != 0) %>%
  count(Q4.6_5, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_5$Q4.6_5 <- factor(Q4.6_5$Q4.6_5, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_5)

# Viz
ggplot(Q4.6_5, aes(x = "", y = n, fill = Q4.6_5)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "The data are in a repository that I know checks/curates the data",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_5, aes(x = n, y = Q4.6_5)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "The data are in a repository that I know checks/curates the data",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_6 The data are associated with a peer review article (6) 
```{r Q4.6_6}
Q4.6_6 <-
  sod %>%
  select(Survey, Q4.6_6) %>%
    drop_na()

# Keep only valid responses
Q4.6_6 <- Q4.6_6 %>%
    group_by(Survey) %>%
    subset(Q4.6_6 != 0) %>%
  count(Q4.6_6, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_6$Q4.6_6 <- factor(Q4.6_6$Q4.6_6, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_6)

# Viz
ggplot(Q4.6_6, aes(x = "", y = n, fill = Q4.6_6)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "The data are associated with a peer review article",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_6, aes(x = n, y = Q4.6_6)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "The data are associated with a peer review article",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_7 Data visualizations (e.g. figures, charts) reflect the true state of the source data (7) 
```{r Q4.6_7}
Q4.6_7 <-
  sod %>%
  select(Survey, Q4.6_7) %>%
    drop_na()

# Keep only valid responses
Q4.6_7 <- Q4.6_7 %>%
    group_by(Survey) %>%
    subset(Q4.6_7 != 0) %>%
  count(Q4.6_7, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_7$Q4.6_7 <- factor(Q4.6_7$Q4.6_7, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_7)

# Viz
ggplot(Q4.6_7, aes(x = "", y = n, fill = Q4.6_7)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "Data visualizations (e.g. figures, charts) reflect the true state of the source data",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_7, aes(x = n, y = Q4.6_7)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "Data visualizations (e.g. figures, charts) reflect the true state of the source data",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_8 Data is consistent with previously published findings (8) 
```{r Q4.6_8}
Q4.6_8 <-
  sod %>%
  select(Survey, Q4.6_8) %>%
    drop_na()

# Keep only valid responses
Q4.6_8 <- Q4.6_8 %>%
    group_by(Survey) %>%
    subset(Q4.6_8 != 0) %>%
  count(Q4.6_8, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_8$Q4.6_8 <- factor(Q4.6_8$Q4.6_8, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_8)

# Viz
ggplot(Q4.6_8, aes(x = "", y = n, fill = Q4.6_8)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "Data is consistent with previously published findings",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_8, aes(x = n, y = Q4.6_8)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "Data is consistent with previously published findings",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_9 Data are presented in a clear and understandable way (data layout, content and format etc.) (9) 
```{r Q4.6_9}
Q4.6_9 <-
  sod %>%
  select(Survey, Q4.6_9) %>%
    drop_na()

# Keep only valid responses
Q4.6_9 <- Q4.6_9 %>%
    group_by(Survey) %>%
    subset(Q4.6_9 != 0) %>%
  count(Q4.6_9, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_9$Q4.6_9 <- factor(Q4.6_9$Q4.6_9, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_9)

# Viz
ggplot(Q4.6_9, aes(x = "", y = n, fill = Q4.6_9)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "Data are presented in a clear and understandable way (data layout, content and format etc.)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_9, aes(x = n, y = Q4.6_9)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "Data are presented in a clear and understandable way (data layout, content and format etc.)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_10 The data set is complete for my needs (10) 
```{r Q4.6_10}
Q4.6_10 <-
  sod %>%
  select(Survey, Q4.6_10) %>%
    drop_na()

# Keep only valid responses
Q4.6_10 <- Q4.6_10 %>%
    group_by(Survey) %>%
    subset(Q4.6_10 != 0) %>%
  count(Q4.6_10, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_10$Q4.6_10 <- factor(Q4.6_10$Q4.6_10, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_10)

# Viz
ggplot(Q4.6_10, aes(x = "", y = n, fill = Q4.6_10)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "The data set is complete for my needs",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_10, aes(x = n, y = Q4.6_10)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "The data set is complete for my needs",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_11 Data have clear descriptions, classifications and coding (i.e. data are accompanied with sufficient context) (11) 
```{r Q4.6_11}
Q4.6_11 <-
  sod %>%
  select(Survey, Q4.6_11) %>%
    drop_na()

# Keep only valid responses
Q4.6_11 <- Q4.6_11 %>%
    group_by(Survey) %>%
    subset(Q4.6_11 != 0) %>%
  count(Q4.6_11, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_11$Q4.6_11 <- factor(Q4.6_11$Q4.6_11, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_11)

# Viz
ggplot(Q4.6_11, aes(x = "", y = n, fill = Q4.6_11)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "Data have clear descriptions, classifications and coding (i.e. data are accompanied with sufficient context)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_11, aes(x = n, y = Q4.6_11)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "Data have clear descriptions, classifications and coding (i.e. data are accompanied with sufficient context)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.6_12 The data have been highly used, i.e. they have high usage metrics (e.g. citations, downloads, views etc.) (12) 
```{r Q4.6_12}
Q4.6_12 <-
  sod %>%
  select(Survey, Q4.6_12) %>%
    drop_na()

# Keep only valid responses
Q4.6_12 <- Q4.6_12 %>%
    group_by(Survey) %>%
    subset(Q4.6_12 != 0) %>%
  count(Q4.6_12, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.6_12$Q4.6_12 <- factor(Q4.6_12$Q4.6_12, levels = c("Extremely important",	"Somewhat important", "Moderately important", "Slightly important", "Not at all important", "I don't know"))

kable(Q4.6_12)

# Viz
ggplot(Q4.6_12, aes(x = "", y = n, fill = Q4.6_12)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
    subtitle = "The data have been highly used, i.e. they have high usage metrics (e.g. citations, downloads, views etc.)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.6_12, aes(x = n, y = Q4.6_12)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How would you rate the importance of each of the following with reference to determining the quality of an openly accessible data set?",
        subtitle = "The data have been highly used, i.e. they have high usage metrics (e.g. citations, downloads, views etc.)",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.7 To what extent do you agree/disagree with the following statements?: Strongly agree (1)	Somewhat agree (2)	Neutral (3)	Somewhat disagree (4)	Strongly disagree (5)
Q4.7_1 Data that are 'easy' to find and access improves my perception of its quality (1)
```{r Q4.7_1}
Q4.7_1 <-
  sod %>%
  select(Survey, Q4.7_1) %>%
    drop_na()

# Keep only valid responses
Q4.7_1 <- Q4.7_1 %>%
    group_by(Survey) %>%
    subset(Q4.7_1 != 0) %>%
  count(Q4.7_1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.7_1$Q4.7_1 <- factor(Q4.7_1$Q4.7_1, levels = c("Strongly agree",	"Somewhat agree",	"Neutral", "Somewhat disagree", "Strongly disagree"))

kable(Q4.7_1)

# Viz
ggplot(Q4.7_1, aes(x = "", y = n, fill = Q4.7_1)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent do you agree/disagree with the following statements?:",
    subtitle = "Data that are 'easy' to find and access improves my perception of its quality",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.7_1, aes(x = n, y = Q4.7_1)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent do you agree/disagree with the following statements?:",
    subtitle = "Data that are 'easy' to find and access improves my perception of its quality",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.7_2 Shared data add to the credibility of a research article (2) 
```{r Q4.7_2}
Q4.7_2 <-
  sod %>%
  select(Survey, Q4.7_2) %>%
    drop_na()

# Keep only valid responses
Q4.7_2 <- Q4.7_2 %>%
    group_by(Survey) %>%
    subset(Q4.7_2 != 0) %>%
  count(Q4.7_2, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

Q4.7_2$Q4.7_2 <- factor(Q4.7_2$Q4.7_2, levels = c("Strongly agree",	"Somewhat agree",	"Neutral", "Somewhat disagree", "Strongly disagree"))

kable(Q4.7_2)

# Viz
ggplot(Q4.7_2, aes(x = "", y = n, fill = Q4.7_2)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent do you agree/disagree with the following statements?:",
    subtitle = "Shared data add to the credibility of a research article",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.7_2, aes(x = n, y = Q4.7_2)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "To what extent do you agree/disagree with the following statements?:",
    subtitle = "Shared data add to the credibility of a research article",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.8 We would now like to ask you to think about the last occasion on which you tried to get access to a data set produced by another research group. Please answer the following questions with this experience in mind. Were you able to get access to the data set?
```{r Q4.8}
Q4.8 <-
  sod %>%
  select(Survey, Q4.8) %>%
    drop_na()

# Keep only valid responses
Q4.8 <- Q4.8 %>%
    group_by(Survey) %>%
    subset(Q4.8 != 0) %>%
  count(Q4.8, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.8)

# Viz
ggplot(Q4.8, aes(x = "", y = n, fill = Q4.8)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Were you able to get access to the data set?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.8, aes(x = n, y = Q4.8)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Were you able to get access to the data set?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.9 How did you gain access to the data set?
```{r Q4.9}
Q4.9 <-
  sod %>%
  select(Survey, Q4.9) %>%
    drop_na()

# Keep only valid responses
Q4.9 <- Q4.9 %>%
    group_by(Survey) %>%
    subset(Q4.9 != 0) %>%
  count(Q4.9, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.9)

# Viz
ggplot(Q4.9, aes(x = "", y = n, fill = Q4.9)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How did you gain access to the data set?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.9, aes(x = n, y = Q4.9)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How did you gain access to the data set?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.10 What was included in the data set?
```{r Q4.10}
Q4.10_1 <- select(sod, Survey, Q4.10_1) %>% rename("Q4.10" = "Q4.10_1")
Q4.10_2 <- select(sod, Survey, Q4.10_2) %>% rename("Q4.10" = "Q4.10_2")
Q4.10_3 <- select(sod, Survey, Q4.10_3) %>% rename("Q4.10" = "Q4.10_3")
Q4.10_4 <- select(sod, Survey, Q4.10_4) %>% rename("Q4.10" = "Q4.10_4")
Q4.10_5 <- select(sod, Survey, Q4.10_5) %>% rename("Q4.10" = "Q4.10_5")
Q4.10_6 <- select(sod, Survey, Q4.10_6) %>% rename("Q4.10" = "Q4.10_6")
Q4.10_7 <- select(sod, Survey, Q4.10_7) %>% rename("Q4.10" = "Q4.10_7")
Q4.10_8 <- select(sod, Survey, Q4.10_8) %>% rename("Q4.10" = "Q4.10_8")

Q4.10 <- rbind(Q4.10_1, Q4.10_2, Q4.10_3, Q4.10_4, Q4.10_5, Q4.10_6, Q4.10_7, Q4.10_8)
rm(Q4.10_1, Q4.10_2, Q4.10_3, Q4.10_4, Q4.10_5, Q4.10_6, Q4.10_7, Q4.10_8)

# Keep only valid responses
Q4.10 <- Q4.10 %>%
    group_by(Survey) %>%
    subset(Q4.10 != 0) %>%
  count(Q4.10, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.10)

# Viz
ggplot(Q4.10, aes(x = "", y = n, fill = Q4.10)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What was included in the data set?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.10, aes(x = n, y = Q4.10)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What was included in the data set?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.11 Were you able to reuse the dataset for your intended purpose?
```{r Q4.11}
Q4.11 <-
  sod %>%
  select(Survey, Q4.11) %>%
    drop_na()

# Keep only valid responses
Q4.11 <- Q4.11 %>%
    group_by(Survey) %>%
    subset(Q4.11 != 0) %>%
  count(Q4.11, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.11)

# Viz
ggplot(Q4.11, aes(x = "", y = n, fill = Q4.11)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Were you able to reuse the dataset for your intended purpose?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.11, aes(x = n, y = Q4.11)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Were you able to reuse the dataset for your intended purpose?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q4.12 Why were you unable to reuse the dataset for your intended purpose?
```{r Q4.12}
Q4.12_1 <- select(sod, Survey, Q4.12_1) %>% rename("Q4.12" = "Q4.12_1")
Q4.12_2 <- select(sod, Survey, Q4.12_2) %>% rename("Q4.12" = "Q4.12_2")
Q4.12_3 <- select(sod, Survey, Q4.12_3) %>% rename("Q4.12" = "Q4.12_3")
Q4.12_4 <- select(sod, Survey, Q4.12_4) %>% rename("Q4.12" = "Q4.12_4")
Q4.12_5 <- select(sod, Survey, Q4.12_5) %>% rename("Q4.12" = "Q4.12_5")
Q4.12_6 <- select(sod, Survey, Q4.12_6) %>% rename("Q4.12" = "Q4.12_6")

Q4.12 <- rbind(Q4.12_1, Q4.12_2, Q4.12_3, Q4.12_4, Q4.12_5, Q4.12_6)
rm(Q4.12_1, Q4.12_2, Q4.12_3, Q4.12_4, Q4.12_5, Q4.12_6)

# Keep only valid responses
Q4.12 <- Q4.12 %>%
    group_by(Survey) %>%
    subset(Q4.12 != 0) %>%
  count(Q4.12, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q4.12)

# Viz
ggplot(Q4.12, aes(x = "", y = n, fill = Q4.12)) +
  geom_bar(stat = "identity", width = .375) +
  geom_text(aes(label = paste0(Pct)),
            position = position_stack(vjust = .5),
            size = 2.5) +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Why were you unable to reuse the dataset for your intended purpose?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
            axis.text = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q4.12, aes(x = n, y = Q4.12)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Why were you unable to reuse the dataset for your intended purpose?",
    subtitle = "Last occasion on which you tried to get access to a data set produced by another research group", 
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

### Credit and recognition for data sharing
Q5.1 Do you think researchers currently get sufficient credit for sharing data?
```{r Q5.1}
Q5.1 <-
  sod %>%
  select(Survey, Q5.1) %>%
    drop_na()

# Keep only valid responses
Q5.1 <- Q5.1 %>%
  subset(Q5.1 != 0) %>%
    group_by(Survey) %>%
  count(Q5.1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q5.1)

# Viz
ggplot(Q5.1, aes(x = Survey, y = n, fill = Q5.1)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Do you think researchers currently get sufficient credit for sharing data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q5.1, aes(x=(Survey), y = n, fill = Q5.1)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Do you think researchers currently get sufficient credit for sharing data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q5.2 What circumstances would motivate you to share your data?
```{r Q5.2}
Q5.2_1 <- select(sod, Survey, Q5.2_1) %>% rename("Q5.2" = "Q5.2_1")
Q5.2_2 <- select(sod, Survey, Q5.2_2) %>% rename("Q5.2" = "Q5.2_2")
Q5.2_3 <- select(sod, Survey, Q5.2_3) %>% rename("Q5.2" = "Q5.2_3")
Q5.2_4 <- select(sod, Survey, Q5.2_4) %>% rename("Q5.2" = "Q5.2_4")
Q5.2_5 <- select(sod, Survey, Q5.2_5) %>% rename("Q5.2" = "Q5.2_5")
Q5.2_6 <- select(sod, Survey, Q5.2_6) %>% rename("Q5.2" = "Q5.2_6")
Q5.2_7 <- select(sod, Survey, Q5.2_7) %>% rename("Q5.2" = "Q5.2_7")
Q5.2_8 <- select(sod, Survey, Q5.2_8) %>% rename("Q5.2" = "Q5.2_8")
Q5.2_9 <- select(sod, Survey, Q5.2_9) %>% rename("Q5.2" = "Q5.2_9")
Q5.2_10 <- select(sod, Survey, Q5.2_10) %>% rename("Q5.2" = "Q5.2_10")
Q5.2_11 <- select(sod, Survey, Q5.2_11) %>% rename("Q5.2" = "Q5.2_11")
Q5.2_12 <- select(sod, Survey, Q5.2_12) %>% rename("Q5.2" = "Q5.2_12")
Q5.2_13 <- select(sod, Survey, Q5.2_13) %>% rename("Q5.2" = "Q5.2_13")
Q5.2_14 <- select(sod, Survey, Q5.2_14) %>% rename("Q5.2" = "Q5.2_14")
Q5.2_15 <- select(sod, Survey, Q5.2_15) %>% rename("Q5.2" = "Q5.2_15")
Q5.2_16 <- select(sod, Survey, Q5.2_16) %>% rename("Q5.2" = "Q5.2_16")
Q5.2_17 <- select(sod, Survey, Q5.2_17) %>% rename("Q5.2" = "Q5.2_17")
Q5.2_18 <- select(sod, Survey, Q5.2_18) %>% rename("Q5.2" = "Q5.2_18")

Q5.2 <- rbind(Q5.2_1, Q5.2_2, Q5.2_3, Q5.2_4, Q5.2_5, Q5.2_6, Q5.2_7, Q5.2_8, Q5.2_9, Q5.2_10, Q5.2_11, Q5.2_12, Q5.2_13, Q5.2_14, Q5.2_15, Q5.2_16, Q5.2_17, Q5.2_18)
rm(Q5.2_1, Q5.2_2, Q5.2_3, Q5.2_4, Q5.2_5, Q5.2_6, Q5.2_7, Q5.2_8, Q5.2_9, Q5.2_10, Q5.2_11, Q5.2_12, Q5.2_13, Q5.2_14, Q5.2_15, Q5.2_16, Q5.2_17, Q5.2_18)

# Keep only valid responses
Q5.2 <- Q5.2 %>%
  subset(Q5.2 != 0) %>%
    group_by(Survey) %>%
  count(Q5.2, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q5.2)

# Viz
ggplot(Q5.2, aes(x = Survey, y = n, fill = Q5.2)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What circumstances would motivate you to share your data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q5.2, aes(x=(Survey), y = n, fill = Q5.2)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What circumstances would motivate you to share your data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q5.3 Which one of the circumstances would motivate you the most to share your data?
```{r Q5.3}
Q5.3 <-
  sod %>%
  select(Survey, Q5.3) %>%
    drop_na()

# Keep only valid responses
Q5.3 <- Q5.3 %>%
  subset(Q5.3 != 0) %>%
    group_by(Survey) %>%
  count(Q5.3, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q5.3)

# Viz
ggplot(Q5.3, aes(x = Survey, y = n, fill = Q5.3)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Which one of the circumstances would motivate you the most to share your data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q5.3, aes(x=(Survey), y = n, fill = Q5.3)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Which one of the circumstances would motivate you the most to share your data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q5.4 If the reuse of your data in a subsequent paper resulted in you being credited as a co-author, how much would this motivate you to make your data openly available to others?
```{r Q5.4}
Q5.4 <-
  sod %>%
  select(Survey, Q5.4) %>%
    drop_na()

# Keep only valid responses
Q5.4 <- Q5.4 %>%
  subset(Q5.4 != 0) %>%
    group_by(Survey) %>%
  count(Q5.4, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q5.4)

# Viz
ggplot(Q5.4, aes(x = Survey, y = n, fill = Q5.4)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "If the reuse of your data in a subsequent paper resulted in you being credited as a co-author, how much would this motivate you to make your data openly available to others?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q5.4, aes(x=(Survey), y = n, fill = Q5.4)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "If the reuse of your data in a subsequent paper resulted in you being credited as a co-author, how much would this motivate you to make your data openly available to others?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q5.5 Have you ever received credit/acknowledgement for sharing data?
```{r Q5.5}
Q5.5 <-
  sod %>%
  select(Survey, Q5.5) %>%
    drop_na()

# Keep only valid responses
Q5.5 <- Q5.5 %>%
  subset(Q5.5 != 0) %>%
    group_by(Survey) %>%
  count(Q5.5, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q5.5)

# Viz
ggplot(Q5.5, aes(x = Survey, y = n, fill = Q5.5)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Have you ever received credit/acknowledgement for sharing data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q5.5, aes(x=(Survey), y = n, fill = Q5.5)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Have you ever received credit/acknowledgement for sharing data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q5.6 What recognition have you received for sharing your research data?
```{r Q5.6}
Q5.6_1 <- select(sod, Survey, Q5.6_1) %>% rename("Q5.6" = "Q5.6_1")
Q5.6_2 <- select(sod, Survey, Q5.6_2) %>% rename("Q5.6" = "Q5.6_2")
Q5.6_3 <- select(sod, Survey, Q5.6_3) %>% rename("Q5.6" = "Q5.6_3")
Q5.6_4 <- select(sod, Survey, Q5.6_4) %>% rename("Q5.6" = "Q5.6_4")
Q5.6_5 <- select(sod, Survey, Q5.6_5) %>% rename("Q5.6" = "Q5.6_5")
Q5.6_6 <- select(sod, Survey, Q5.6_6) %>% rename("Q5.6" = "Q5.6_6")
Q5.6_7 <- select(sod, Survey, Q5.6_7) %>% rename("Q5.6" = "Q5.6_7")
Q5.6_8 <- select(sod, Survey, Q5.6_8) %>% rename("Q5.6" = "Q5.6_8")

Q5.6 <- rbind(Q5.6_1, Q5.6_2, Q5.6_3, Q5.6_4, Q5.6_5, Q5.6_6, Q5.6_7, Q5.6_8)
rm(Q5.6_1, Q5.6_2, Q5.6_3, Q5.6_4, Q5.6_5, Q5.6_6, Q5.6_7, Q5.6_8)

# Keep only valid responses
Q5.6 <- Q5.6 %>%
  subset(Q5.6 != 0) %>%
    group_by(Survey) %>%
  count(Q5.6, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q5.6)

# Viz
ggplot(Q5.6, aes(x = Survey, y = n, fill = Q5.6)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What recognition have you received for sharing your research data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q5.6, aes(x=(Survey), y = n, fill = Q5.6)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What recognition have you received for sharing your research data?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q5.7 How supportive would you be of a national mandate for making research data openly available?
```{r Q5.7}
Q5.7 <-
  sod %>%
  select(Survey, Q5.7) %>%
    drop_na()

# Keep only valid responses
Q5.7 <- Q5.7 %>%
  subset(Q5.7 != 0) %>%
    group_by(Survey) %>%
  count(Q5.7, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q5.7)

# Viz
ggplot(Q5.7, aes(x = Survey, y = n, fill = Q5.7)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How supportive would you be of a national mandate for making research data openly available?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q5.7, aes(x=(Survey), y = n, fill = Q5.7)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "How supportive would you be of a national mandate for making research data openly available?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q5.8 Should funders withhold funding from (or penalise in other ways) researchers who do not share their data if the funder has mandated that they do so at the grant application stage?
```{r Q5.8}
Q5.8 <-
  sod %>%
  select(Survey, Q5.8) %>%
    drop_na()

# Keep only valid responses
Q5.8 <- Q5.8 %>%
  subset(Q5.8 != 0) %>%
    group_by(Survey) %>%
  count(Q5.8, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q5.8)

# Viz
ggplot(Q5.8, aes(x = Survey, y = n, fill = Q5.8)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Should funders withhold funding from (or penalise in other ways) researchers who do not share their data if the funder has mandated that they do so at the grant application stage?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q5.8, aes(x=(Survey), y = n, fill = Q5.8)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Should funders withhold funding from (or penalise in other ways) researchers who do not share their data if the funder has mandated that they do so at the grant application stage?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q5.9 Should funders make the sharing of research data part of their requirements for awarding grants?
```{r Q5.9}
Q5.9 <-
  sod %>%
  select(Survey, Q5.9) %>%
    drop_na()

# Keep only valid responses
Q5.9 <- Q5.9 %>%
  subset(Q5.9 != 0) %>%
    group_by(Survey) %>%
  count(Q5.9, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q5.9)

# Viz
ggplot(Q5.9, aes(x = Survey, y = n, fill = Q5.9)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Should funders make the sharing of research data part of their requirements for awarding grants?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q5.9, aes(x=(Survey), y = n, fill = Q5.9)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Should funders make the sharing of research data part of their requirements for awarding grants?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

### Demographics
Q6.1 About you
```{r Q6.1}
Q6.1 <-
  sod %>%
  select(Survey, Q6.1) %>%
    drop_na()

# Keep only valid responses
Q6.1 <- Q6.1 %>%
  subset(Q6.1 != 0) %>%
    group_by(Survey) %>%
  count(Q6.1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q6.1)

# Viz
ggplot(Q6.1, aes(x = Survey, y = n, fill = Q6.1)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "About you",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q6.1, aes(x=(Survey), y = n, fill = Q6.1)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "About you",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q6.4 What is your current tenure status?
```{r Q6.4}
Q6.4 <-
  sod %>%
  select(Survey, Q6.4) %>%
    drop_na()

# Keep only valid responses
Q6.4 <- Q6.4 %>%
  subset(Q6.4 != 0) %>%
    group_by(Survey) %>%
  count(Q6.4, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q6.4)

# Viz
ggplot(Q6.4, aes(x = Survey, y = n, fill = Q6.4)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What is your current tenure status?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q6.4, aes(x=(Survey), y = n, fill = Q6.4)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "What is your current tenure status?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```

Q6.5 Which country are you located in?
```{r Q6.5}
Q6.5 <-
  sod %>%
  select(Survey, Q6.5) %>%
    drop_na()

# Keep only valid responses
Q6.5 <- Q6.5 %>%
  subset(Q6.5 != 0) %>%
    group_by(Survey) %>%
  count(Q6.5, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%"))

kable(Q6.5)
```

Q6.5_1 Which continent are you located in?
```{r Q6.5_1}
Q6.5_1 <-
  sod %>%
  select(Survey, "6.5_1") %>%
    drop_na()

# Keep only valid responses
Q6.5_1 <- Q6.5_1 %>%
  rename(Q6.5_1 = "6.5_1") %>%
  subset(Q6.5_1 != 0) %>%
    group_by(Survey) %>%
  count(Q6.5_1, sort = TRUE) %>% 
  mutate(Pct = paste0(round(n / sum(n) * 100, 1), "%")) # Rename column

kable(Q6.5_1)

# Viz
ggplot(Q6.5_1, aes(x = Survey, y = n, fill = Q6.5_1)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Which continent are you located in?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
) +
  coord_flip()

ggplot(Q6.5_1, aes(x=(Survey), y = n, fill = Q6.5_1)) +
  geom_col(position = position_dodge()) +
  labs(
    x = NULL,
    y = NULL,
    title = "Which continent are you located in?",
    caption = "State of Open Data Survey 2021",
    fill = ""
  ) +
  theme_classic() +
  theme(
        legend.position = "bottom",
    axis.line = element_blank(),
    axis.ticks = element_blank()
)
```